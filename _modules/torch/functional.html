<!DOCTYPE html>
<html lang="zh_CN">
<head>
  <meta charset="UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>torch.functional — PyTorch main documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://pytorch.org/docs/stable/_modules/torch/functional.html">
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css">
  <!-- <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css">
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css">
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" type="text/css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" type="text/css">
  <link rel="stylesheet" href="../../_static/katex-math.css" type="text/css">
  <link rel="stylesheet" href="../../_static/sphinx-dropdown.css" type="text/css">
  <link rel="stylesheet" href="../../_static/panels-bootstrap.min.css" type="text/css">
  <link rel="stylesheet" href="../../_static/css/jit.css" type="text/css">
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css">
    <link rel="index" title="Index" href="../../genindex.html">
    <link rel="search" title="Search" href="../../search.html">

<!--
  Search engines should not index the main version of documentation.
  Stable documentation are built without release == 'main'.
-->
<meta name="robots" content="noindex">


  <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T8XT4PS');</script>
    <!-- End Google Tag Manager -->
  


  
  <script src="../../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head><body class="pytorch-body"><div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>

          <li class="main-menu-item">
          <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">学习</a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/get-started">
                  <span class="dropdown-title">开始使用</span>
                  <p>在本地运行 PyTorch 或快速开始使用支持的云平台之一</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tutorials">
                  <span class="dropdown-title">教程</span><p></p>
                  <p>PyTorch 教程中的新内容</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/beginner/basics/intro.html">
                  <span class="dropdown-title">学习基础知识</span><p></p>
                  <p>熟悉 PyTorch 概念和模块</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/recipes/recipes_index.html">
                  <span class="dropdown-title">PyTorch 烹饪技巧</span><p></p>
                  <p>精简型、可直接部署的 PyTorch 代码示例</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/beginner/introyt.html">
                  <span class="dropdown-title">PyTorch 入门 - YouTube 系列</span><p></p>
                  <p>通过我们引人入胜的 YouTube 教程系列掌握 PyTorch 基础知识</p>
                </a>
              </div>
            </div>
          </li>

          <li>
          <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">生态系统</a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/ecosystem">
                  <span class="dropdown-title">工具</span><p></p>
                  <p>了解 PyTorch 生态系统中的工具和框架</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/#community-module">
                  <span class="dropdown-title">社区</span>
                  <p>加入 PyTorch 开发者社区，贡献、学习并获得问题解答</p>
                </a>
                <a class="nav-dropdown-item" href="https://discuss.pytorch.org/" target="_blank">
                  <span class="dropdown-title">论坛</span>
                  <p>讨论 PyTorch 代码、问题、安装、研究的地方</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/resources">
                  <span class="dropdown-title">开发者资源</span>
                  <p>查找资源并解答问题</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/ecosystem/contributor-awards-2024">
                  <span class="dropdown-title">2024 年度贡献者奖项</span><p></p>
                  <p>本届 PyTorch 会议揭晓获奖者</p>
                </a>
              </div>
            </div>
          </li>

          <li>
          <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
                Edge
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/edge">
                  <span class="dropdown-title">关于 PyTorch Edge</span><p></p>
                  <p>为边缘设备构建创新和隐私感知的 AI 体验</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/executorch-overview">
                  <span class="dropdown-title">ExecuTorch</span><p></p>
                  <p>针对移动和边缘设备实现设备端推理能力的端到端解决方案</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/executorch/stable/index.html">
                  <span class="dropdown-title">ExecuTorch 文档</span><p></p>
                </a>
              </div>
            </div>  
          </li>

          <li class="main-menu-item">
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">文档</a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/docs/stable/index.html">
                  <span class="dropdown-title">PyTorch</span><p></p>
                  <p>探索文档以获取如何使用 PyTorch 的全面指南</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/pytorch-domains">
                  <span class="dropdown-title">PyTorch 领域</span><p></p>
                  <p>阅读 PyTorch 领域的文档以了解更多关于特定领域的库</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">博客与新闻</a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/blog/">
                  <span class="dropdown-title">PyTorch 博客</span><p></p>
                  <p>跟上最新的技术新闻和动态</p>
                </a>
                 <a class="nav-dropdown-item" href="https://pytorch.org/community-blog">
                  <span class="dropdown-title">社区博客</span><p></p>
                  <p>PyTorch 生态系统故事</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/videos">
                  <span class="dropdown-title">视频</span><p></p>
                  <p>了解最新的 PyTorch 教程、新内容等</p>
                </a><a class="nav-dropdown-item" href="https://pytorch.org/community-stories">
                  <span class="dropdown-title">社区故事</span><p></p>
                  <p>了解我们的社区如何使用 PyTorch 解决真实、日常的机器学习问题</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/events">
                  <span class="dropdown-title">活动</span><p></p>
                  <p>查找活动、网络研讨会和播客</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/newsletter">
                  <span class="dropdown-title">通讯</span><p></p>
                  <p>保持最新更新</p>
                </a>
            </div>
          </div></li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">关于</a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/foundation">
                  <span class="dropdown-title">PyTorch 基金会</span><p></p>
                  <p>了解更多关于 PyTorch 基金会的信息</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/governing-board">
                  <span class="dropdown-title">管理委员会</span><p></p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/credits">
                  <span class="dropdown-title">云信用计划</span><p></p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tac">
                  <span class="dropdown-title">技术顾问委员会</span><p></p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/staff">
                  <span class="dropdown-title">员工</span><p></p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/contact-us">
                  <span class="dropdown-title">联系我们</span><p></p>
                </a>
              </div>
            </div>
          </li>

          <li class="main-menu-item">
            <div class="no-dropdown">
              <a href="https://pytorch.org/join" data-cta="join">成为会员</a>
            </div>
          </li>
          <li>
           <div class="main-menu-item">
             <a href="https://github.com/pytorch/pytorch" class="github-icon">
             </a>
           </div>
          </li>
          <!--- TODO: This block adds the search icon to the nav bar. We will enable it later. 
          <li>
            <div class="main-menu-item">
             <a href="https://github.com/pytorch/pytorch" class="search-icon">
             </a>
            </div>
          </li>
          --->
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>



   

    

    <div class="table-of-contents-link-wrapper">
      <span>目录</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            
    <div class="version">
      <a href="https://pytorch.org/docs/versions.html">主页 (2.7.0+cpu ) ▼</a>
    </div>
    <div id="searchBox">
    <div class="searchbox" id="googleSearchBox">
      <script async="" src="https://cse.google.com/cse.js?cx=e65585f8c3ea1440e"></script>
      <div class="gcse-search"></div>
    </div>
    <div id="sphinxSearchBox" style="display: none;">
      <div role="search">
        <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
          <input type="text" name="q" placeholder="Search Docs">
          <input type="hidden" name="check_keywords" value="yes">
          <input type="hidden" name="area" value="default">
        </form>
      </div>
    </div>
  </div>
  <form id="searchForm">
    <label style="margin-bottom: 1rem">
      <input type="radio" name="searchType" value="google" checked="">Google 搜索</label>
    <label style="margin-bottom: 1rem">
      <input type="radio" name="searchType" value="sphinx">经典搜索</label>
  </form>

  <script>
     document.addEventListener('DOMContentLoaded', function() {
      const searchForm = document.getElementById('searchForm');
      const googleSearchBox = document.getElementById('googleSearchBox');
      const sphinxSearchBox = document.getElementById('sphinxSearchBox');
      // Function to toggle search box visibility
      function toggleSearchBox(searchType) {
        googleSearchBox.style.display = searchType === 'google' ? 'block' : 'none';
        sphinxSearchBox.style.display = searchType === 'sphinx' ? 'block' : 'none';
      }
      // Determine the default search type
      let defaultSearchType;
      const currentUrl = window.location.href;
      if (currentUrl.startsWith('https://pytorch.org/docs/stable')) {
        // For the stable documentation, default to Google
        defaultSearchType = localStorage.getItem('searchType') || 'google';
      } else {
        // For any other version, including docs-preview, default to Sphinx
        defaultSearchType = 'sphinx';
      }
      // Set the default search type
      document.querySelector(`input[name="searchType"][value="${defaultSearchType}"]`).checked = true;
      toggleSearchBox(defaultSearchType);
      // Event listener for changes in search type
      searchForm.addEventListener('change', function(event) {
        const selectedSearchType = event.target.value;
        localStorage.setItem('searchType', selectedSearchType);
        toggleSearchBox(selectedSearchType);
      });
      // Set placeholder text for Google search box
      window.onload = function() {
        var placeholderText = "Search Docs";
        var googleSearchboxText = document.querySelector("#gsc-i-id1");
        if (googleSearchboxText) {
          googleSearchboxText.placeholder = placeholderText;
          googleSearchboxText.style.fontFamily = 'FreightSans';
          googleSearchboxText.style.fontSize = "1.2rem";
          googleSearchboxText.style.color = '#262626';
        }
      };
    });
  </script>

          </div>

          

<div>
  <a style="color:#F05732" href="https://pytorch.org/docs/stable/_modules/torch/functional.html">您正在查看不稳定开发者预览文档。请点击此处查看最新稳定版本的文档。</a>
</div>


            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">社区</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../community/build_ci_governance.html">PyTorch 治理 | 构建 + CI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/contribution_guide.html">PyTorch 贡献指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/design.html">PyTorch 设计哲学</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/governance.html">PyTorch 治理 | 机制</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/persons_of_interest.html">PyTorch 治理 | 维护者</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">开发者笔记</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../notes/amp_examples.html">自动混合精度示例</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/autograd.html">Autograd 机制</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/broadcasting.html">广播语义</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/cpu_threading_torchscript_inference.html">CPU 线程和 TorchScript 推理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/cuda.html">CUDA 语义</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/custom_operators.html">PyTorch 自定义操作着陆页面</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/ddp.html">分布式数据并行</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/extending.html">扩展 PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/extending.func.html">扩展 torch.func 与 autograd.Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/faq.html">常见问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/fsdp.html">FSDP 笔记</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/get_start_xpu.html">在英特尔 GPU 上入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/gradcheck.html">毕业审核力学</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/hip.html">HIP (ROCm) 语义</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/large_scale_deployments.html">大规模部署功能</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/libtorch_stable_abi.html">LibTorch 稳定 ABI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/modules.html">模块</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/mps.html">MPS 后端</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/multiprocessing.html">多进程最佳实践</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/numerical_accuracy.html">数值精度</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/randomness.html">可复现性</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/serialization.html">序列化语义</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notes/windows.html">Windows 常见问题解答</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">语言绑定</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cpp_index.html">C++</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/javadoc/">Javadoc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deploy.html">torch::deploy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../torch.html">torch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nn.html">torch.nn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nn.functional.html">torch.nn.functional</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tensors.html">torch.Tensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tensor_attributes.html">Tensor 属性</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tensor_view.html">张量视图</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../amp.html">torch.amp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autograd.html">torch.autograd</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../library.html">torch.library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../accelerator.html">torch 加速器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpu.html">torch.cpu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cuda.html">torch.cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../torch_cuda_memory.html">理解 CUDA 内存使用</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../torch_cuda_memory.html#generating-a-snapshot">生成快照</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../torch_cuda_memory.html#using-the-visualizer">使用可视化器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../torch_cuda_memory.html#snapshot-api-reference">快照 API 参考</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mps.html">torch.mps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../xpu.html">torch.xpu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mtia.html">torch.mtia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mtia.memory.html">torch.mtia.memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../meta.html">元设备</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../backends.html">torch.backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../export.html">torch.export</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../distributed.html">torch.distributed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../distributed.tensor.html">torch.distributed.tensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../distributed.algorithms.join.html">torch.distributed.algorithms.join</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../distributed.elastic.html">torch.distributed.elastic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fsdp.html">torch.distributed.fsdp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../distributed.fsdp.fully_shard.html">torch.distributed.fsdp.fully_shard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../distributed.tensor.parallel.html">torch.distributed.tensor.parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../distributed.optim.html">torch.distributed.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../distributed.pipelining.html">torch.distributed.pipelining</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../distributed.checkpoint.html">torch.distributed.checkpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../distributions.html">torch.distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../torch.compiler.html">torch.compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fft.html">torch.fft</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../func.html">torch.func</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../futures.html">torch.futures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fx.html">torch.fx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fx.experimental.html">torch.fx.experimental</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hub.html">torch.hub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jit.html">torch.jit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../linalg.html">torch.linalg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../monitor.html">torch.monitor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../signal.html">torch.signal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../special.html">torch.special</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../torch.overrides.html">torch.overrides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../package.html">torch.package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../profiler.html">torch.profiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nn.init.html">torch.nn.init</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nn.attention.html">torch.nn.attention</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../onnx.html">torch.onnx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../optim.html">torch.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../complex_numbers.html">复数</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ddp_comm_hooks.html">DDP 通信钩子</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quantization.html">量化</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rpc.html">分布式 RPC 框架</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../random.html">torch.random</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../masked.html">torch.masked</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nested.html">torch.nested</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../size.html">torch.Size</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sparse.html">torch.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../storage.html">torch 存储</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing.html">torch.testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utils.html">torch.utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../benchmark_utils.html">torch.utils.benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bottleneck.html">torch.utils.bottleneck</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../checkpoint.html">torch.utils.checkpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp_extension.html">torch.utils.cpp_extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data.html">torch.utils.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deterministic.html">torch.utils.deterministic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jit_utils.html">torch.utils.jit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dlpack.html">torch.utils.dlpack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mobile_optimizer.html">torch.utils.mobile_optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../model_zoo.html">torch.utils.model_zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tensorboard.html">torch.utils.tensorboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../module_tracker.html">torch.utils.module_tracker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../type_info.html">类型信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../named_tensor.html">命名张量</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../name_inference.html">命名张量操作覆盖率</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../config_mod.html">torch.__config__</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../future_mod.html">torch.__future__</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../logging.html">torch._logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../torch_environment_variables.html">火炬环境变量</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">图书馆</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/audio/stable">torchaudio</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/data">TorchData</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/torchrec">火炬推荐</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/serve">TorchServe</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/text/stable">torchtext</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/vision/stable">torchvision</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/xla/">PyTorch 在 XLA 设备上</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/ao">torchao</a></li>
</ul>

            
          

        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        文档 &gt;</li>

        
          <li>模块代码 &gt;</li>
        
          <li><a href="../torch.html">torch</a> &gt;</li>
        
      <li>torch.functional</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">快捷键</div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        

          <!-- Google Tag Manager (noscript) -->
          <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8XT4PS" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
          <!-- End Google Tag Manager (noscript) -->
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <h1>torch.functional 源代码</font></font></font></h1><div class="highlight"><pre><span></span><span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># mypy: 允许未类型化定义</span>
<span class="kn">导入</span> <span class="nn">itertools</span>
<span class="kn">导入</font></font></font></span> <span class="nn"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">操作符</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">导入</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">序列</span>
<span class="kn">from</span> <span class="nn">打字</font></font></font></span> <span class="kn"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">导入</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">任何</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">类型检查</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">联合</span>

<span class="kn">导入</font></font></font></span> <span class="nn"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</span>
<span class="kn">导入</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">from</span> <span class="nn">火炬</font></font></font></span> <span class="kn"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">导入</font></font></font></span> <span class="n">_VF</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span>
<span class="kn">from</span> <span class="nn">torch._C</span> <span class="kn">导入</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">添加文档字符串</span>
<span class="kn">from</span> <span class="nn">torch._jit_internal</span> <span class="kn">导入</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">覆盖</font></font></font></span> <span class="k">as</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">过载</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">boolean 分派</span>
<span class="kn">from</span> <span class="nn">torch._低秩</font></font></font></span> <span class="kn"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">导入</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">pca 低秩</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">svd 低秩</span>
<span class="kn">from</span> <span class="nn">torch.overrides</span> <span class="kn">导入</span> <span class="p">(</span>
    <span class="n">handle_torch_function</span><span class="p">,</span>
    <span class="n">有 torch 功能</span><span class="p">,</span>
    <span class="n">has_torch_function_unary</span><span class="p">,</span>
    <span class="n">has_torch_function_variadic</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">全部</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">"至少_1 天"</span><span class="p">,</span>
    <span class="s2">"至少_2 天"</span><span class="p">,</span>
    <span class="s2">"至少_3 天"</span><span class="p">,</span>
    <span class="s2">"对齐张量"</span><span class="p">,</span>
    <span class="s2">"广播形状"</span><span class="p">,</span>
    <span class="s2">"广播张量"</span><span class="p">,</span>
    <span class="s2">"笛卡尔积"</span><span class="p">,</span>
    <span class="s2">"块对角矩阵"</span><span class="p">,</span>
    <span class="s2">"cdist"</span><span class="p">,</span>
    <span class="s2">"chain_matmul"</span><span class="p">,</span>
    <span class="s2">"einsum"</span><span class="p">,</span>
    <span class="s2">"istft"</span><span class="p">,</span>
    <span class="s2">"lu"</span><span class="p">,</span>
    <span class="s2">"norm"</span><span class="p">,</span>
    <span class="s2">"meshgrid"</span><span class="p">,</span>
    <span class="s2">"pca_lowrank"</span><span class="p">,</span>
    <span class="s2">"拆分"</span><span class="p">,</span>
    <span class="s2">"stft"</span><span class="p">,</span>
    <span class="s2">"SVD 低秩"</span><span class="p">,</span>
    <span class="s2">"张量点"</span><span class="p">,</span>
    <span class="s2">"唯一"</span><span class="p">,</span>
    <span class="s2">独特连续</span><span class="p">,</span>
    <span class="s2">"unravel_index"</span><span class="p">,</span>
<span class="p">]</span>


<div class="viewcode-block" id="broadcast_tensors"><font class=" " lang="zh-CN"><br hidden=""><font class="    "><font class="  ">[文档]def broadcast_tensors(*tensors): 
广播张量(*tensors)
广播张量(*tensors) -&gt; 张量列表

广播给定的张量，根据：:ref:`广播语义`.

Args:
*tensors: 同类型张量的任意数量

.. warning::

超过广播张量的一个元素可能指向单个
内存位置。因此，原地操作（尤其是那些
可能因向量化而导致行为不正确。如果您需要编写
请先克隆这些张量。

示例：

&gt;&gt;&gt; x = torch.arange(3).view(1, 3)
&gt;&gt;&gt; y = torch.arange(2).view(2, 1)
&gt;&gt;&gt; a, b = torch.broadcast_tensors(x, y)
&gt;&gt;&gt; a.size()
torch.Size([2, 3])
&gt;&gt;&gt; a
tensor([[0, 1, 2],
[0, 1, 2]])
"""
# 此包装器存在以支持可变参数。
if has_torch_function(tensors):
return handle_torch_function(broadcast_tensors, tensors, *tensors)
return _VF.broadcast_tensors(tensors)  # 忽略未定义的属性</font></font></font></div>


<div class="viewcode-block" id="broadcast_shapes"><a class="viewcode-back" href="../../generated/torch.broadcast_shapes.html#torch.broadcast_shapes">[文档]</font></font></font></a><span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">广播形状</font></font></font></span><span class="p">(</span><span class="o">*</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">"""broadcast_shapes(*shapes) -&gt; 大小</span>

<span class="sd">类似于 :func:`broadcast_tensors` 但用于形状。</span>

<span class="sd">这相当于</span>
<span class="sd">    ``torch.broadcast_tensors(*map(torch.empty, shapes))[0].shape``</span>
<span class="sd">但避免了创建中间张量的需求。这在某些情况下很有用</span>
<span class="sd">广播具有相同批量形状但不同最右形状的张量，</span>
<span class="sd">例如，将均值向量广播到协方差矩阵。</span>

<span class="sd">示例::</span>

<span class="sd">        &gt;&gt;&gt; torch.broadcast_shapes((2,), (3, 1), (1, 1, 1))</span>
<span class="sd">        torch.Size([1, 3, 2])</span>

<span class="sd">参数：</span>
<span class="sd">\*shapes (torch.Size): 张量的形状。</span>

<span class="sd">返回值：</span>
<span class="sd">shape (torch.Size): 与所有输入形状兼容的形状。</span>

<span class="sd">抛出异常：</span>
<span class="sd">RuntimeError: 如果形状不兼容。</span>
<span class="sd">    """</span>
    <span class="c1"># 此包装器存在是为了支持可变参数。</span>
    <span class="c1">一旦 jit 对 torch.Size 的支持更好，就将其移动到 C++</span>
    <span class="k">如果</font></font></font></span> <span class="ow">not</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">算子</span><span class="o">.</span><span class="n">is_tracing</span><span class="p">():</span>
        <span class="n">最大长度</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">对于</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">进入</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">:</span>
            <span class="k">如果</font></font></font></span> <span class="nb">isinstance</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</font></font></font></span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</span><span class="o">.</span><span class="n">SymInt</span><span class="p">)):</span>
                <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">最大长度</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">最大长度</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">形状</font></font></font></span><span class="p">,</span> <span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">元组</font></font></font></span><span class="p">,</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</span><span class="p">)):</span>
                <span class="n">s</span> <span class="o">=</span> <span class="nb">长度</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">)</span>
                <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">最大长度</span> <span class="o">&lt;</span> <span class="n">s</span><span class="p">:</span>
                    <span class="n">最大长度</span> <span class="o">=</span> <span class="n">s</span>
        <span class="n">结果</font></font></font></span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">最大长度</span>

        <span class="kn">from</span> <span class="nn">torch.fx.experimental.symbolic_shapes</span> <span class="kn">导入</span> <span class="p">(</span>
            <span class="n">守护大小无关</span><span class="p">,</span>
            <span class="n">是否嵌套整型</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">对于</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">进入</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">:</span>
            <span class="k">如果</font></font></font></span> <span class="nb">isinstance</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</font></font></font></span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</span><span class="o">.</span><span class="n">SymInt</span><span class="p">)):</span>
                <span class="n">形状</font></font></font></span> <span class="o">=</span> <span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">,)</span>
            <span class="k">如果</font></font></font></span> <span class="nb">isinstance</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</font></font></font></span><span class="p">,</span> <span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">元组</font></font></font></span><span class="p">,</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</span><span class="p">)):</span>
                <span class="k">对于</font></font></font></span> <span class="n">i</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">进入</font></font></font></span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">范围</font></font></font></span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">长度</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">抛出</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">尝试创建具有负维度的张量（</font></font></font></span><span class="si">{</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</font></font></font></span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">): (</span><span class="si">{</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">)"</span>
                        <span class="p">)</span>

                    <span class="c1"># NB: 处理嵌套整数特别小心，以避免在 Ne(j0, 1) 上无效的守卫。</span>
                    <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是否嵌套整型</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</font></font></font></span><span class="p">[</span><span class="n">i</span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">)]</span>
                        <span class="c1"># 允许广播为 (j0, 1) 或 (j0, j0)；</span>
                        <span class="c1"># 不允许 (j0, j1)，(j0, 5) 等。</span>
                        <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是否嵌套整型</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">结果</font></font></font></span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">和</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">守护大小无关</span><span class="p">(</span>
                            <span class="n">形状</font></font></font></span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">结果</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="p">):</span>
                            <span class="k">continue</span>
                    <span class="k">否则</span><span class="p">:</span>
                        <span class="c1"># NB: 结果初始化为 1 所以这实际上是一个</span>
                        <span class="c1"># 等于一个测试</span>
                        <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">守护大小无关</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</font></font></font></span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">或者</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">守护大小无关</span><span class="p">(</span>
                            <span class="n">形状</font></font></font></span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">结果</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="p">):</span>
                            <span class="k">continue</span>

                    <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">结果</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">抛出</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                            <span class="s2">形状不匹配：对象无法广播到单个形状</span>
                        <span class="p">)</span>
                    <span class="n">结果</font></font></font></span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">否则</span><span class="p">:</span>
                <span class="k">抛出</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">输入形状应为 int 类型、int 元组或 int 列表，却得到了</span><span class="p">,</span>
                    <span class="n">形状</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">尺寸</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">结果</span><span class="p">)</span>
    <span class="k">否则</span><span class="p">:</span>
        <span class="c1">在上述实现中，torch.jit.trace 会硬编码大小，这导致后续重放失败</span>
        <span class="k">替换为</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">不梯度</span><span class="p">():</span>
            <span class="n">标量</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">零值</font></font></font></span><span class="p">((),</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">设备</span><span class="o">=</span><span class="s2">"cpu"</span><span class="p">)</span>
            <span class="n">张量</font></font></font></span> <span class="o">=</span> <span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">标量</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">展开</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</font></font></font></span><span class="p">)</span> <span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">对于</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">进入</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">]</span>
            <span class="n">张量</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">广播张量</font></font></font></span><span class="p">(</span><span class="o">*</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">)</span>
            <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span></div>


<div class="viewcode-block" id="split"><a class="viewcode-back" href="../../generated/torch.split.html#torch.split">[文档]</font></font></font></a><span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">分割</span><span class="p">(</span>
    <span class="n">张量</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">,</span>
    <span class="n">分割大小或部分</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">联合</font></font></font></span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
    <span class="n">维度</font></font></font></span><span class="p">:</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">整型</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">元组</font></font></font></span><span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="o">...</span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">]</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">将张量分割成块。每个块是原始张量的视图。</span>

<span class="sd">如果 `split_size_or_sections` 是一个整型，则 `tensor` 将被分割成等大小的块（如果可能）。如果沿着给定维度 `dim` 的张量大小不能被 `split_size` 整除，则最后一个块将更小。</span>
<span class="sd">如果沿着给定维度 `dim` 的张量大小不能被 `split_size` 整除，则最后一个块将更小。</span>
<span class="sd">如果沿着给定维度 `dim` 的张量大小不能被 `split_size` 整除，则最后一个块将更小。</span>
<span class="sd">如果沿着给定维度 `dim` 的张量大小不能被 `split_size` 整除，则最后一个块将更小。</span>

<span class="sd">如果 :attr:`split_size_or_sections` 是一个列表，那么 :attr:`tensor` 将会被分割</span>
<span class="sd"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">将输入文本翻译为简体中文如下：

将输入文本分为 `len(split_size_or_sections)` 个大小在 `:attr:`dim` 中的块</font></font></font></span>
<span class="sd">到：`split_size_or_sections` 属性。</span>

<span class="sd">参数：</span>
<span class="sd">张量（Tensor）：要分割的张量。</span>
<span class="sd">单个块的大小或分块数（int）或（int 列表）：单个块的大小或分块数列表</span>
<span class="sd">每个块的大小列表</span>
<span class="sd">dim（int）：分割张量的维度。</span>

<span class="sd">示例::</span>

<span class="sd">        &gt;&gt;&gt; a = torch.arange(10).reshape(5, 2)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        tensor([[0, 1],</span>
<span class="sd">                [2, 3],</span>
<span class="sd">                [4, 5],</span>
<span class="sd">[6, 7]</span>
<span class="sd">[8, 9]]</span>
<span class="sd">        &gt;&gt;&gt; torch.split(a, 2)</span>
<span class="sd">        (tensor([[0, 1],</span>
<span class="sd">                 [2, 3]]),</span>
<span class="sd">         tensor([[4, 5],</span>
<span class="sd">                 [6, 7]]),</span>
<span class="sd">         tensor([[8, 9]]))</span>
<span class="sd">        &gt;&gt;&gt; torch.split(a, [1, 4])</span>
<span class="sd">        (tensor([[0, 1]]),</span>
<span class="sd">         tensor([[2, 3],</span>
<span class="sd">                 [4, 5],</span>
<span class="sd">[6, 7]</span>
<span class="sd">[8, 9]</span>
<span class="sd">    """</span>
    <span class="k">如果</font></font></font></span> <span class="n">has_torch_function_unary</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">):</span>
        <span class="k">返回</span> <span class="n">handle_torch_function</span><span class="p">(</span>
            <span class="n">分割</font></font></font></span><span class="p">,</span> <span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,),</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">分割大小或部分</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span>
        <span class="p">)</span>
    <span class="c1"># 覆盖原因：</span>
    <span class="c1"># 这将根据 split_size_or_sections 的类型调用两个 ATen 函数</span>
    <span class="c1"># 分支代码在 _tensor.py 中</span>
    <span class="c1">#请在此处调用。</span>
    <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">分割</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">分割大小或部分</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">)</span></div>


<div class="viewcode-block" id="einsum"><a class="viewcode-back" href="../../generated/torch.einsum.html#torch.einsum">[文档]</font></font></font></a><span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">定义</font></font></font></span> <span class="nf">einsum</span><span class="p">(</span><span class="o">*</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">参数</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">任何</font></font></font></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">"einsum(equation, *operands) -&gt; Tensor"</span>

<span class="sd">对输入 :attr:`operands` 的元素乘积沿指定维度求和。</span>
<span class="sd">基于爱因斯坦求和约定。</span>

<span class="sd">Einsum 允许通过表示来计算许多常见的多维线性代数数组操作。</span>
<span class="sd">以爱因斯坦求和约定为基础的简写格式，由：attr:`equation` 给出。该格式的详细信息如下，但基本思想是给输入的每个：attr:`operands` 维度标注一个下标，并定义哪些下标是输出的一部分。输出然后通过计算那些下标不属于输出的：attr:`operands` 元素沿维度的乘积之和来得到。</span>
<span class="sd">该格式的具体描述如下，但基本思想是给输入的每个：attr:`operands` 维度标注一个下标，并定义哪些下标是输出的一部分。</span>
<span class="sd">输出是通过计算那些下标不属于输出的：attr:`operands` 元素沿维度的乘积之和来得到的。</span>
<span class="sd">输出是通过计算那些下标不属于输出的：attr:`operands` 元素沿维度的乘积之和来得到的。</span>
<span class="sd">输出。例如，可以使用 einsum 计算矩阵乘法，如 `torch.einsum("ij,jk-&gt;ik", A, B)`。</span>
<span class="sd">其中，j 是求和下标，i 和 k 是输出下标（详见下文了解更多细节）。</span>

<span class="sd">公式：</span>

<span class="sd">attr:`equation` 字符串指定了每个维度的下标（字母 `[a-zA-Z]`）。</span>
<span class="sd">输入：attr:`operands`，按照维度顺序排列，每个操作数的下标用逗号（','）分隔</span>
<span class="sd">例如，`'ij,jk'`指定了两个二维操作数的下标。具有相同下标的维度必须是可广播的，也就是说，它们的大小必须匹配或为`1`。例外情况是，如果某个下标对于同一个输入操作数重复出现，在这种情况下，对于此操作数的该下标所标记的维度</span>
<span class="sd">必须是可广播的，即它们的大小必须匹配或为`1`。例外情况是如果某个下标对于同一个输入操作数重复出现，在这种情况下，对于此操作数的该下标所标记的维度</span>
<span class="sd">必须是可广播的，即它们的大小必须匹配或为`1`。例外情况是如果某个下标对于同一个输入操作数重复出现，在这种情况下，对于此操作数的该下标所标记的维度</span>
<span class="sd">必须大小匹配，操作数将被其对这些维度的对角线替换。</span>
<span class="sd">在 :attr:`equation` 中恰好出现一次的下标将包含在输出中，并按字母顺序升序排列。</span>
<span class="sd">输出是通过逐元素相乘输入的 :attr:`operands`，根据下标对齐维度，然后对不包含在输出中的维度进行求和计算得到的。</span>
<span class="sd">输出是通过逐元素相乘输入的 :attr:`operands`，根据下标对齐维度，然后对不包含在输出中的维度进行求和计算得到的。</span>

<span class="sd">可选地，输出下标可以显式定义，方法是在等式末尾添加箭头（'-&gt;'）</span>
<span class="sd">然后跟输出下标。例如，以下等式计算矩阵乘法的转置：'ij,jk-&gt;ki'。输出下标必须至少在某个输入操作数中出现一次，并且在输出中最多出现一次。</span>
<span class="sd">矩阵乘法：'ij,jk-&gt;ki'。输出下标必须至少在某个输入操作数中出现一次，并且在输出中最多出现一次。</span>
<span class="sd">输出下标必须至少在某个输入操作数中出现一次，并且在输出中最多出现一次。</span>

<span class="sd">省略号（'...'）可以用作下标，以表示省略号覆盖的维度。</span>
<span class="sd">每个输入操作数最多只能有一个省略号，它将覆盖下标未覆盖的维度，</span>
<span class="sd">例如，对于一个具有 5 个维度的输入操作数，方程 `'ab...c'` 中的省略号覆盖了第三和第四维度。</span>
<span class="sd">省略号不需要在所有操作数上覆盖相同数量的维度，但</span>
<span class="sd">省略号（它们覆盖的维度大小）的 'shape' 必须一起广播。如果输出没有明确地使用箭头 ('-&gt;') 符号定义，省略号将首先出现在输出中（最左侧的维度），</span>
<span class="sd">在出现一次的输入操作数的下标标签之前。例如，以下方程实现了批矩阵乘法 `'...ij,...jk'`。</span>
<span class="sd">在出现一次的输入操作数的下标标签之前。例如，以下方程实现了批矩阵乘法 `'...ij,...jk'`。</span>
<span class="sd">在出现一次的输入操作数的下标标签之前。例如，以下方程实现了批矩阵乘法 `'...ij,...jk'`。</span>

<span class="sd">一些最后的注意事项：该方程可能在不同元素（下标、省略号等）之间包含空格</span>
<span class="sd">箭头和逗号）但类似于 `'. . .'` 的格式是无效的。对于标量操作数，空字符串 `''` 是有效的。</span>

<span class="sd">.. 注意::</span>

<span class="sd">torch.einsum 处理省略号('...')的方式与 NumPy 不同，因为它允许维度</span>
<span class="sd">被省略号覆盖以进行求和，即省略号不需要成为输出的一部分。</span>

<span class="sd">.. 注意::</span>

<span class="sd">请安装 opt-einsum（https://optimized-einsum.readthedocs.io/en/stable/）以便加入更高效的 einstein 求和操作。</span>
<span class="sd">您可以在安装 torch 时安装它，如下所示：`pip install torch[opt-einsum]`，或者单独安装。</span>
<span class="sd">使用`pip install opt-einsum`进行安装。</span>

<span class="sd">如果 opt-einsum 可用，此函数将自动加速计算并/或减少内存消耗。</span>
<span class="sd">通过通过我们的 opt_einsum 后端优化收缩顺序：mod:`torch.backends.opt_einsum`（_与-之间的区别，我知道，很令人困惑）。当至少有三个输入时，才会发生这种优化，因为顺序并不重要</span>
<span class="sd">注意，找到`最优`路径是一个 NP 难题，因此，opt-einsum 依赖于不同的启发式方法来获得近似最优结果。如果 opt-einsum 不可用，则默认的顺序是收缩</span>
<span class="sd">。请注意，找到`最优`路径是一个 NP 难题，因此，opt-einsum 依赖于不同的启发式方法来获得近似最优结果。如果 opt-einsum 不可用，则默认的顺序是收缩</span>
<span class="sd">。如果 opt-einsum 不可用，则默认的顺序是收缩</span>
<span class="sd">从左到右。</span>

<span class="sd">要绕过此默认行为，请添加以下内容以禁用 opt_einsum 并跳过路径计算：</span>
<span class="sd">        ``torch.backends.opt_einsum.enabled = False``</span>

<span class="sd">要指定 opt_einsum 计算收缩路径的策略，请添加以下行：</span>
<span class="sd">``torch.backends.opt_einsum.strategy = 'auto'`` 默认策略为 'auto'，同时我们也支持 'greedy' 和 'optimal'。</span>
<span class="sd">注意，'optimal' 的运行时间与输入数量呈阶乘关系！更多详情请参阅 opt_einsum 文档（https://optimized-einsum.readthedocs.io/en/stable/path_finding.html）。</span>
<span class="sd">截至 PyTorch 1.10，:func:`torch.einsum` 也支持子列表格式（以下有示例）。在此格式中，</span>

<span class="sd">.. 注意::</span>

<span class="sd">有关详细信息，请参阅 PyTorch 1.10 的 :func:`torch.einsum` 文档。</span>
<span class="sd">每个操作数的下标由子列表指定，子列表是范围在[0, 52)内的整数列表。这些子列表</span>
<span class="sd">跟随其操作数，并且输入末尾可以额外出现一个子列表来指定输出的下标，例如`torch.einsum(op1, sublist1, op2, sublist2, ..., [subslist_out])`。Python 的`Ellipsis`对象</span>
<span class="sd">可以在子列表中提供，以启用如上方程部分所述的广播。</span>
<span class="sd">提供在子列表中，以启用如上方程部分所述的广播。</span>

<span class="sd">参数：</span>
<span class="sd">方程（字符串）：爱因斯坦求和的子脚标。</span>
<span class="sd">操作数（张量列表）：计算爱因斯坦求和的张量。</span>

<span class="sd">示例：</span>

<span class="sd">&gt;&gt;&gt; # xdoctest: +IGNORE_WANT("非确定性")</span>
<span class="sd">&gt;&gt;&gt; # 跟踪</span>
<span class="sd">        &gt;&gt;&gt; torch.einsum('ii', torch.randn(4, 4))</span>
<span class="sd">张量(-1.2104)</span>

<span class="sd">&gt;&gt;&gt; # xdoctest: +IGNORE_WANT("非确定性")</span>
<span class="sd">&gt;&gt;&gt; # 对角线</span>
<span class="sd">        &gt;&gt;&gt; torch.einsum('ii-&gt;i', torch.randn(4, 4))</span>
<span class="sd">张量([-0.1034,  0.7952, -0.2433,  0.4545])</span>

<span class="sd">&gt;&gt;&gt; # xdoctest: +IGNORE_WANT("非确定性")</span>
<span class="sd">&gt;&gt;&gt; # 外积</span>
<span class="sd">        &gt;&gt;&gt; x = torch.randn(5)</span>
<span class="sd">        &gt;&gt;&gt; y = torch.randn(4)</span>
<span class="sd">        &gt;&gt;&gt; torch.einsum('i,j-&gt;ij', x, y)</span>
<span class="sd">        tensor([[ 0.1156, -0.2897, -0.3918,  0.4963],</span>
<span class="sd">                [-0.3744,  0.9381,  1.2685, -1.6070],</span>
<span class="sd">                [ 0.7208, -1.8058, -2.4419,  3.0936],</span>
<span class="sd">                [ 0.1713, -0.4291, -0.5802,  0.7350],</span>
<span class="sd">[0.5704, -1.4290, -1.9323, 2.4480]])</span>

<span class="sd">&gt;&gt;&gt; # xdoctest: +IGNORE_WANT("非确定性")</span>
<span class="sd">&gt;&gt;&gt; # 批量矩阵乘法</span>
<span class="sd">        &gt;&gt;&gt; As = torch.randn(3, 2, 5)</span>
<span class="sd">        &gt;&gt;&gt; Bs = torch.randn(3, 5, 4)</span>
<span class="sd">        &gt;&gt;&gt; torch.einsum('bij,bjk-&gt;bik', As, Bs)</span>
<span class="sd">tensor([[[[-1.0564, -1.5904,  3.2023,  3.1271],</span>
<span class="sd">[[-1.6706, -0.8097, -0.8025, -2.1183]]</span>

<span class="sd">[[4.2239, 0.3107, -0.5756, -0.2354]]</span>
<span class="sd">[[-1.4558, -0.3460, 1.5087, -0.8530]]</span>

<span class="sd">[[2.8153, 1.8787, -4.3839, -1.2112]]</span>
<span class="sd">[[0.3728, -2.1131, 0.0921, 0.8305]]])</span>

<span class="sd">&gt;&gt;&gt; # xdoctest: +IGNORE_WANT("非确定性")</span>
<span class="sd">&gt;&gt;&gt; # 使用子列表格式和省略号</span>
<span class="sd">        &gt;&gt;&gt; torch.einsum(As, [..., 0, 1], Bs, [..., 1, 2], [..., 0, 2])</span>
<span class="sd">tensor([[[[-1.0564, -1.5904,  3.2023,  3.1271],</span>
<span class="sd">[[-1.6706, -0.8097, -0.8025, -2.1183]]</span>

<span class="sd">[[4.2239, 0.3107, -0.5756, -0.2354]]</span>
<span class="sd">[[-1.4558, -0.3460, 1.5087, -0.8530]]</span>

<span class="sd">[[2.8153, 1.8787, -4.3839, -1.2112]]</span>
<span class="sd">[[0.3728, -2.1131, 0.0921, 0.8305]]])</span>

<span class="sd">&gt;&gt;&gt; # 批量排列</span>
<span class="sd">        &gt;&gt;&gt; A = torch.randn(2, 3, 4, 5)</span>
<span class="sd">        &gt;&gt;&gt; torch.einsum('...ij-&gt;...ji', A).shape</span>
<span class="sd">        torch.Size([2, 3, 5, 4])</span>

<span class="sd">&gt;&gt;&gt; 等价于 torch.nn.functional.bilinear</span>
<span class="sd">        &gt;&gt;&gt; A = torch.randn(3, 5, 4)</span>
<span class="sd">        &gt;&gt;&gt; l = torch.randn(2, 5)</span>
<span class="sd">        &gt;&gt;&gt; r = torch.randn(2, 4)</span>
<span class="sd">        &gt;&gt;&gt; torch.einsum('bn,anm,bm-&gt;ba', l, A, r)</span>
<span class="sd">        tensor([[-0.3430, -5.2405,  0.4494],</span>
<span class="sd">                [ 0.3311,  5.5201, -3.0356]])</span>
<span class="sd">    """</span>
    <span class="kn">导入</span> <span class="nn">torch.backends.opt_einsum</span> <span class="k">as</span> <span class="nn">opt_einsum</span>

    <span class="c1"># 此包装器存在是为了支持可变参数。</span>
    <span class="k">如果</font></font></font></span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">长度</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">参数</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">抛出</font></font></font></span> <span class="ne"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">值错误</span><span class="p">(</span>
            <span class="s2">"einsum()：必须指定方程字符串和至少一个操作数，"</span>
            <span class="s2">"至少一个操作数及其下标列表"</span>
        <span class="p">)</span>

    <span class="n">方程</font></font></font></span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span>
    <span class="n">操作数</font></font></font></span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span>

    <span class="k">如果</font></font></font></span> <span class="nb">isinstance</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">参数</font></font></font></span><span class="p">[</span><span class="mi">0</span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">]</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">):</span>
        <span class="c1"># 将操作数及其下标列表的交错格式转换为下标列表格式</span>
        <span class="c1"># 列表，末尾可选输出子脚标列表（更多详细信息请参阅文档）</span>
        <span class="c1">将方程字符串格式化为从下标列表创建方程字符串并分组</span>
        <span class="c1">将输入操作数放入一个 tensorlist（Tensor 列表）中。</span>
        <span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">解析下标</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">如果</font></font></font></span> <span class="n">n</span> <span class="o">==</span> <span class="bp"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">省略号</span><span class="p">:</span>
                <span class="k">返回</span> <span class="s2">"..."</span>
            <span class="k">如果</font></font></font></span> <span class="n">n</span> <span class="o"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">≥</font></font></font></span> <span class="mi">0</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">和</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">26</span><span class="p">:</span>
                <span class="k">返回</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s2">"A"</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">如果</font></font></font></span> <span class="n">n</span> <span class="o"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">≥</font></font></font></span> <span class="mi">26</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">和</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">52</span><span class="p">:</span>
                <span class="k">返回</font></font></font></span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"一个"</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">26</span><span class="p">)</span>
            <span class="k">抛出</font></font></font></span> <span class="ne"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">值错误</span><span class="p">(</span>
                <span class="s2">"einsum(): 索引列表中的索引不在有效范围 [0, 52) 内"</span>
            <span class="p">)</span>

        <span class="c1"># 解析输入操作数的下标</span>
        <span class="n">方程</font></font></font></span> <span class="o">=</span> <span class="s2">","</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">连接</font></font></font></span><span class="p">(</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入文本翻译为简体中文为：""</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">连接</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">解析下标</font></font></font></span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">对于</font></font></font></span> <span class="n">s</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">进入</font></font></font></span> <span class="n">l</span><span class="p">)</span> <span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">对于</font></font></font></span> <span class="n">l</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">进入</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">参数</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span>

        <span class="c1">解析可选的输出下标（当参数数量为奇数时提供）</span>
        <span class="k">如果</font></font></font></span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">长度</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">参数</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">方程</font></font></font></span> <span class="o">+=</span> <span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"→"</font></font></font></span> <span class="o">+</span> <span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入文本翻译为简体中文为：""</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">连接</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">解析下标</font></font></font></span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">对于</font></font></font></span> <span class="n">s</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">进入</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">参数</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">操作数</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">参数</font></font></font></span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">否则</span><span class="p">:</span>
            <span class="n">操作数</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">参数</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">否则</span><span class="p">:</span>
        <span class="n">方程</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">参数</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">操作数</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">参数</font></font></font></span><span class="p">[</span><span class="mi">1</span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">]</span>

    <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">有 torch 功能</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">操作数</span><span class="p">):</span>
        <span class="k">返回</font></font></font></span> <span class="n">handle_torch_function</span><span class="p">(</span><span class="n">einsum</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">操作数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">方程</font></font></font></span><span class="p">,</span> <span class="o">*</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">操作数</span><span class="p">)</span>

    <span class="k">如果</font></font></font></span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">长度</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">操作数</font></font></font></span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">和</font></font></font></span> <span class="nb">isinstance</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">操作数</font></font></font></span><span class="p">[</span><span class="mi">0</span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">]</font></font></font></span> <span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</font></font></font></span><span class="p">,</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">元组</span><span class="p">)):</span>
        <span class="c1"># 将操作数作为单个列表参数传递的旧接口</span>
        <span class="n">_操作数</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">操作数</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># 递归，如果操作数包含具有 torch 函数的值</span>
        <span class="c1"># 在原始实现中，此行被省略</span>
        <span class="k">返回</font></font></font></span> <span class="n">einsum</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">方程</font></font></font></span><span class="p">,</span> <span class="o">*</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">操作数</span><span class="p">)</span>

    <span class="k">如果</font></font></font></span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">长度</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">操作数</font></font></font></span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">或者</font></font></font></span> <span class="ow">not</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">OptEinsum</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">启用</span><span class="p">:</span>
        <span class="c1">合同路径优化已进行 0 或 1 次</span>
        <span class="c1">或者用户已禁用使用 opt_einsum</span>
        <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">方程</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">操作数</font></font></font></span><span class="p">)</span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># 类型：忽略[已定义]</span>

    <span class="n">路径</font></font></font></span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span>
    <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">OptEinsum</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是否可用</span><span class="p">():</span>
        <span class="n">_opt_einsum</span> <span class="o">=</span> <span class="n">OptEinsum</span><span class="o">.</span><span class="n">get_opt_einsum</span><span class="p">()</span>
        <span class="n">tupled_path</span> <span class="o">=</span> <span class="n">_opt_einsum</span><span class="o">.</span><span class="n">contract_path</span><span class="p">(</span>
            <span class="n">方程</font></font></font></span><span class="p">,</span> <span class="o">*</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">操作数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">优化</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">OptEinsum</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">策略</span>
        <span class="p">)]</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># 分发到 C++的扁平路径</span>
        <span class="n">路径</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">tupled_path</span><span class="p">)]</span>
    <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">方程</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">操作数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">路径</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">路径</span><span class="p">)</span>  <span class="c1"># type: ignore[attr-defined]</span></div>


<span class="c1"># 此包装器存在是为了支持可变参数。</span>
<span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">类型检查</span><span class="p">:</span>
    <span class="c1">JIT 不理解联合类型，因此只为 mypy 添加类型注解。</span>
    <span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">网格</span><span class="p">(</span>
        <span class="o">*</span><span class="n">张量</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">联合</font></font></font></span><span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</font></font></font></span><span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">]],</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">元组</font></font></font></span><span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="o">...</span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">]</span>
        <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">网格</font></font></font></span><span class="p">(</span><span class="o">*</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</span><span class="p">)</span>

<span class="k">否则</span><span class="p">:</span>

<div class="viewcode-block" id="meshgrid"><a class="viewcode-back" href="../../generated/torch.meshgrid.html#torch.meshgrid">[文档]</font></font></font></a>    <span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">网格</font></font></font></span><span class="p">(</span><span class="o">*</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</font></font></font></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">元组</font></font></font></span><span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="o">...</span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">]</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">生成由`attr`:tensors 中的 1D 输入指定的坐标网格。</span>

<span class="sd">这在您想可视化某些数据时非常有用。</span>
<span class="sd">输入范围。以下为绘图示例。</span>

<span class="sd">给定 :math:`N` 个 1D 张量 :math:`T_0 \ldots T_{N-1}` 作为</span>
<span class="sd">输入，对应的大小为 :math:`S_0 \ldots S_{N-1}`，</span>
<span class="sd">这将创建 :math:`N` 个 N 维张量 :math:`G_0 \ldots</span>
<span class="sd">\( G_{N-1} \)，每个的形状为：\( (S_0, ..., S_{N-1}) \)</span>
<span class="sd">输出 \( G_i \) 通过展开 \( T_i \) 构建。</span>
<span class="sd">将结果扩展到结果形状。</span>

<span class="sd">.. 注意::</span>
<span class="sd">0 维输入等效于 1 维输入。</span>
<span class="sd">单个元素。</span>

<span class="sd">..警告：</span>
<span class="sd">`torch.meshgrid(*tensors)` 目前具有相同的行为</span>
<span class="sd">作为调用 `numpy.meshgrid(*arrays, indexing='ij')`。</span>

<span class="sd">未来 `torch.meshgrid` 将过渡到</span>
<span class="sd">默认为 `indexing='xy'`。</span>

<span class="sd">请参阅 https://github.com/pytorch/pytorch/issues/50276 跟踪。</span>
<span class="sd">本问题旨在迁移到 NumPy 的行为。</span>

<span class="sd">参考文献也请参阅。</span>

<span class="sd">`torch.cartesian_prod` 具有相同的效果，但它</span>
<span class="sd">收集数据到一个向量张量中。</span>

<span class="sd">参数：</span>
<span class="sd">张量（Tensor 列表）：标量或一维张量的列表。标量将被</span>
<span class="sd">自动视为大小为 :math:`(1,)` 的张量处理。</span>

<span class="sd">索引模式：(str, 可选): 索引模式，可以是 "xy" 或 "ij"，默认为 "ij"。有关未来更改的警告请参阅。</span>
<span class="sd">或者 "ij"，默认为 "ij"。有关未来更改的警告请参阅。</span>

<span class="sd">如果选择 "xy"，则第一个维度对应第二个输入的基数，第二个维度对应第三个输入的基数。</span>
<span class="sd">维度对应第三个输入的基数。</span>
<span class="sd">维度对应于第一个的基数</span>
<span class="sd">输入</span>

<span class="sd">如果选择“ij”，维度相同</span>
<span class="sd">输入的基数作为顺序。</span>

<span class="sd">返回值：</span>
<span class="sd">seq (序列)：如果输入有 :math:`N`</span>
<span class="sd">张量大小为：`S_0 ... S_{N-1}`，然后</span>
<span class="sd">输出也将包含：`N` 个张量，其中每个张量</span>
<span class="sd">是形状：`（S_0, ..., S_{N-1}）`。</span>

<span class="sd">示例::</span>

<span class="sd">            &gt;&gt;&gt; x = torch.tensor([1, 2, 3])</span>
<span class="sd">            &gt;&gt;&gt; y = torch.tensor([4, 5, 6])</span>

<span class="sd">观察网格中的逐元素配对，(1, 4)，</span>
<span class="sd">(1, 5)，...，（3，6）。这与笛卡尔积相同。</span>
<span class="sd">这是同一件事。</span>
<span class="sd">            &gt;&gt;&gt; grid_x, grid_y = torch.meshgrid(x, y, indexing='ij')</span>
<span class="sd">            &gt;&gt;&gt; grid_x</span>
<span class="sd">            tensor([[1, 1, 1],</span>
<span class="sd">                    [2, 2, 2],</span>
<span class="sd">[[3, 3, 3]]</span>
<span class="sd">            &gt;&gt;&gt; grid_y</span>
<span class="sd">            tensor([[4, 5, 6],</span>
<span class="sd">[[4, 5, 6]]</span>
<span class="sd">[4, 5, 6]]]</span>

<span class="sd">当这些网格正确堆叠时，这种对应关系可以观察到。</span>
<span class="sd">堆叠得当。</span>
<span class="sd">            &gt;&gt;&gt; torch.equal(torch.cat(tuple(torch.dstack([grid_x, grid_y]))),</span>
<span class="sd">torch.cartesian_prod(x, y) 的笛卡尔积</span>
<span class="sd">            True</span>

<span class="sd">`torch.meshgrid` 通常用于生成网格</span>
<span class="sd">用于绘图。</span>
<span class="sd">            &gt;&gt;&gt; # xdoctest: +REQUIRES(module:matplotlib)</span>
<span class="sd">            &gt;&gt;&gt; # xdoctest: +REQUIRES(env:DOCTEST_SHOW)</span>
<span class="sd">&gt;&gt;&gt; 导入 matplotlib.pyplot 库</span>
<span class="sd">            &gt;&gt;&gt; xs = torch.linspace(-5, 5, steps=100)</span>
<span class="sd">            &gt;&gt;&gt; ys = torch.linspace(-5, 5, steps=100)</span>
<span class="sd">            &gt;&gt;&gt; x, y = torch.meshgrid(xs, ys, indexing='xy')</span>
<span class="sd">            &gt;&gt;&gt; z = torch.sin(torch.sqrt(x * x + y * y))</span>
<span class="sd">            &gt;&gt;&gt; ax = plt.axes(projection='3d')</span>
<span class="sd">            &gt;&gt;&gt; ax.plot_surface(x.numpy(), y.numpy(), z.numpy())</span>
<span class="sd">            &gt;&gt;&gt; plt.show()</span>

<span class="sd">.. 图片:: ../_static/img/meshgrid.png</span>
<span class="sd">宽度: 512</span>

<span class="sd">        """</span>
        <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">网格</font></font></font></span><span class="p">(</span><span class="o">*</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</span><span class="p">)</span></div>


<span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">网格</font></font></font></span><span class="p">(</span><span class="o">*</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">[</span><span class="nb">str</span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">)]</span>
    <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">有 torch 功能</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">):</span>
        <span class="k">返回</font></font></font></span> <span class="n">handle_torch_function</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">网格</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="o">*</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</span><span class="p">)</span>
    <span class="k">如果</font></font></font></span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">长度</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">和</font></font></font></span> <span class="nb">isinstance</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">[</span><span class="mi">0</span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">]</font></font></font></span> <span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</font></font></font></span><span class="p">,</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">元组</span><span class="p">)):</span>
        <span class="c1"># 将操作数作为单个列表参数传递的旧接口</span>
        <span class="n">张量</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># 类型：忽略[赋值]</span>

    <span class="c1"># 继续允许调用不带索引的老方法</span>
    <span class="c1"># 为向前兼容添加参数</span>
    <span class="c1">#</span>
    <span class="c1"># 在发布两周后删除此内容</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</font></font></font></span> <span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">否则</font></font></font></span> <span class="p">{</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</span><span class="p">}</span>
    <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">网格</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="o">**</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">关键字参数</font></font></font></span><span class="p">)</span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># 类型：忽略[已定义]</span>


<div class="viewcode-block" id="stft"><a class="viewcode-back" href="../../generated/torch.stft.html#torch.stft">[文档]</font></font></font></a><span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">定义</span> <span class="nf">stft</span><span class="p">(</span>
    <span class="nb">输入</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">,</span>
    <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">跳长</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
    <span class="n">窗长</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
    <span class="n">窗口</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">]</span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
    <span class="n">中心</font></font></font></span><span class="p">:</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">布尔值</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">填充模式</font></font></font></span><span class="p">:</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">字符串</font></font></font></span> <span class="o">=</span> <span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">反射</span><span class="p">,</span>
    <span class="n">标准化</font></font></font></span><span class="p">:</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">布尔值</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">单向的</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
    <span class="n">返回复杂</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
    <span class="n">与窗口对齐</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">张量</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">短时傅里叶变换（STFT）。</span>

<span class="sd">..警告：</span>
<span class="sd">从版本 1.8.0 开始，:attr:`return_complex`必须始终提供</span>
<span class="sd">专门用于真实输入，且`return_complex=False`已被</span>
<span class="sd">已弃用。强烈建议使用 `return_complex=True`，如未来版本中所示</span>
<span class="sd">PyTorch 发布，此函数将仅返回复杂数组。</span>

<span class="sd">请注意：:func:`torch.view_as_real` 可以用于恢复实数</span>
<span class="sd">张量具有一个额外的最后一个维度，用于实部和虚部。</span>

<span class="sd">..警告::</span>
<span class="sd">从版本 2.1 开始，如果未指定 :attr:`window`，将提供警告。在未来版本中，此属性将是必需的。</span>
<span class="sd">如果未指定窗口，从版本 2.1 开始将提供警告。在未来版本中，此属性将成为必需项。</span>
<span class="sd">当前不提供窗口默认使用矩形窗口，</span>
<span class="sd">这可能会导致不希望出现的伪影。请考虑使用锥形窗口，</span>
<span class="sd">例如：:func:`torch.hann_window`。</span>

<span class="sd">STFT 计算短重叠窗口的傅里叶变换</span>
<span class="sd">输入. 这提供信号随时间变化的频率分量</span>
<span class="sd">时间。此功能界面模仿了（但并非*直接替换*）</span>
<span class="sd">替代 librosa_ stft 函数。</span>

<span class="sd">https://librosa.org/doc/latest/generated/librosa.stft.html</span>

<span class="sd">忽略可选的批量维度，此方法计算以下</span>
<span class="sd">表达式：</span>

<span class="sd">    .. math::</span>
<span class="sd">X[ω, m] = ∑_{k = 0}^{win_length-1}%</span>
<span class="sd">window[k] input[m × hop_length + k]%</span>
<span class="sd">\exp\left(- j \frac{2 \pi \cdot \omega k}{n_fft}\right),</span>

<span class="sd">其中 :math:`m` 是滑动窗口的索引，而 :math:`\omega` 是</span>
<span class="sd">频率：$0 \leq \omega &lt; \text{n\_fft}$ 对于 `onesided=False`</span>
<span class="sd">或 $0 \leq \omega &lt; \lfloor \text{n\_fft} / 2 \rfloor + 1$ 对于 `onesided=True`</span>

<span class="sd">* :attr:`input` 必须是 1-D 时间序列或 2-D 时间序列批</span>
<span class="sd">次</span>

<span class="sd">如果 :attr:`hop_length` 为 ``None``（默认），则视为等于</span>
<span class="sd">``floor(n_fft / 4)``。</span>

<span class="sd">如果 :attr:`win_length` 为 ``None``（默认），则视为等于</span>
<span class="sd">attr:`n_fft`。</span>

<span class="sd">* :attr:`window` 可以是一个大小为 :attr:`win_length` 的 1-D 张量，例如从</span>
<span class="sd">torch.hann_window。如果 :attr:`window` 是 ``None``（默认），则是</span>
<span class="sd">被视为窗口中到处都有：数学公式`1`。如果</span>
<span class="sd">`win_length &lt; n_fft` 时，:attr:`window` 将被填充</span>
<span class="sd">在应用之前，对两边的长度进行：attr:`n_fft`。</span>

<span class="sd">如果：attr:`center` 为 ``True``（默认），则：attr:`input` 将被填充。</span>
<span class="sd">以便第：math:`t` 个帧在时间：math:`t \times \text{hop\_length}` 处居中。</span>
<span class="sd">否则，第：math:`t` 个帧。</span>
<span class="sd">开始时间为：:math:`t \times \text{hop\_length}`。</span>

<span class="sd">* :attr:`pad_mode` 决定了在 :attr:`input` 上使用的填充方法。</span>
<span class="sd">attr:`center` 为 ``True``。请参阅 :meth:`torch.nn.functional.pad` 了解所有可用选项。</span>
<span class="sd">默认为 ``"reflect"``。</span>

<span class="sd">如果 :attr:`onesided` 为 ``True``（实数输入的默认值），则只返回</span>
<span class="sd">math:`\omega` 在 :math:`\left[0, 1, 2, \dots, \left\lfloor</span>
<span class="sd">\frac{\text{n\_fft}}{2} \right\rfloor + 1\right]` 范围内的值，因为</span>
<span class="sd">实数到复数的傅里叶变换满足共轭对称性，</span>
<span class="sd">即，:math:`X[m, \omega] = X[m, \text{n\_fft} - \omega]^*`.</span>
<span class="sd">注意，如果输入或窗口张量是复数，则 :attr:`onesided`</span>
<span class="sd">输出不可行。</span>

<span class="sd">* 如果 :attr:`normalized` 为 ``True``（默认为 ``False``），则函数</span>
<span class="sd">返回归一化的 STFT 结果，即乘以 :math:`(frame\_length)^{-0.5}`。</span>

<span class="sd">* 如果 :attr:`return_complex` 为 ``True``（如果输入是复数则为默认值），则返回</span>
<span class="sd">是 ``input.dim() + 1`` 维的复数张量。如果 ``False``，则</span>
<span class="sd">输出是一个 ``input.dim() + 2`` 维的实数张量，其中最后一个</span>
<span class="sd">维度表示实部和虚部。</span>

<span class="sd">返回一个大小为 :math:`(* \times N \times T)` 的复杂张量</span>
<span class="sd">:attr:`return_complex` 为 true，或一个大小为 :math:`(* \times N` 的实张量</span>
<span class="sd">\( \times T \times 2) \)。其中，:math:`*` 是可选的批量大小。</span>
<span class="sd"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入：:attr:`input`, :math:`N` 是应用短时傅里叶变换的频率数量
翻译：输入：:attr:`input`，:math:`N` 是应用短时傅里叶变换的频率数</font></font></font></span>
<span class="sd">并且：`T` 是使用的总帧数。</span>

<span class="sd">..警告：</span>
<span class="sd">此函数在版本 0.4.1 中更改了签名。调用时使用</span>
<span class="sd">前一个签名可能引起错误或返回不正确的结果。</span>

<span class="sd">参数：</span>
<span class="sd">输入（张量）：形状为 `(B?, L)` 的输入张量，其中 `B?` 是可选的批处理维度</span>
<span class="sd">批处理维度</span>
<span class="sd">n_fft（整数）：傅里叶变换的大小</span>
<span class="sd">hop_length（整数，可选）：相邻滑动窗口之间的距离</span>
<span class="sd">帧数。默认值：``None``（视为等于 ``floor(n_fft / 4)``）</span>
<span class="sd">窗口长度（int，可选）：窗口帧和 STFT 滤波器的大小。</span>
<span class="sd">默认值：``None``（视为等于 :attr:`n_fft`）</span>
<span class="sd">窗口（Tensor，可选）：可选的窗口函数。</span>
<span class="sd">形状必须是 1 维且 `&lt;= n_fft`</span>
<span class="sd">默认：`None`（视为全部为 1 秒的窗口）</span>
<span class="sd">center（布尔值，可选）：是否在`input`的两侧进行填充</span>
<span class="sd">以使得第`t`个帧在时间`t × hop_length`处居中。</span>
<span class="sd">默认：``True``</span>
<span class="sd">pad_mode（字符串，可选）：控制填充方法</span>
<span class="sd">attr:`center` 为 ``True``。默认：``"reflect"``</span>
<span class="sd">normalized（布尔值，可选）：控制是否返回归一化的 STFT 结果</span>
<span class="sd">默认：``False``</span>
<span class="sd">onesided（布尔值，可选）：控制是否返回结果的一半</span>
<span class="sd">避免对真实输入的冗余</span>
<span class="sd">默认：对于真实 :attr:`input` 和 :attr:`window`，为 ``True``，否则为 ``False``</span>
<span class="sd">返回复数张量（bool，可选）：是否返回复数张量，或</span>
<span class="sd">带有额外最后一个维度的实数张量。</span>
<span class="sd">用于实部和虚部。</span>

<span class="sd">.. 版本变更:: 2.0</span>
<span class="sd">``return_complex`` 现在对于真实输入是必须的参数，</span>
<span class="sd">因为默认值正在过渡到 ``True``。</span>

<span class="sd">.. 已弃用:: 2.0</span>
<span class="sd">``return_complex=False`` 已弃用，请使用 ``return_complex=True`` 代替</span>
<span class="sd">注意调用 :func:`torch.view_as_real` 对输出进行操作</span>
<span class="sd">可以恢复已弃用的输出格式。</span>

<span class="sd">返回值：</span>
<span class="sd">张量：包含 STFT 结果的张量，形状为`(B?, N, T, C?)`，其中</span>
<span class="sd">- `B?` 是从输入中可选的批处理维度。</span>
<span class="sd">`- N 是频率样本的数量，对于 n_fft // 2 + 1`</span>
<span class="sd">`onesided=True`，否则为 `n_fft`。</span>
<span class="sd">`- T 是帧数，对于 center=True，为 1 + L // hop_length`</span>
<span class="sd">`，否则为 1 + (L - n_fft) // hop_length`。</span>
<span class="sd">- `C?` 是一个可选的长度为 2 的实部和虚部维度</span>
<span class="sd">组件，当 `return_complex=False` 时存在。</span>

<span class="sd">    """</span>
    <span class="k">如果</font></font></font></span> <span class="n">has_torch_function_unary</span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</span><span class="p">):</span>
        <span class="k">返回</span> <span class="n">handle_torch_function</span><span class="p">(</span>
            <span class="n">stft</span><span class="p">,</span>
            <span class="p">(</span><span class="nb">输入</span><span class="p">,),</span>
            <span class="nb">输入</span><span class="p">,</span>
            <span class="n">n_fft</span><span class="p">,</span>
            <span class="n">跳长</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">跳长</span><span class="p">,</span>
            <span class="n">窗长</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">窗长</span><span class="p">,</span>
            <span class="n">窗口</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">窗口</span><span class="p">,</span>
            <span class="n">中心</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">中心</span><span class="p">,</span>
            <span class="n">填充模式</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">填充模式</span><span class="p">,</span>
            <span class="n">标准化</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">标准化</span><span class="p">,</span>
            <span class="n">单向的</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">单向的</span><span class="p">,</span>
            <span class="n">返回复杂</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回复杂</span><span class="p">,</span>
            <span class="n">与窗口对齐</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">与窗口对齐</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">中心</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">和</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">窗口对齐</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="ow">not</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
        <span class="k">抛出</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">"STFT 窗口对齐仅在 center 为 false 时设置"</span>
        <span class="p">)</span>
    <span class="c1"># NOTE: Do not edit. This code will be removed once the forward-compatibility</span>
    <span class="c1">#       period is over for PR #73432</span>
    <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">中心</span><span class="p">:</span>
        <span class="n">信号维度</font></font></font></span> <span class="o">=</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">()</span>
        <span class="n">扩展形状</font></font></font></span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">信号维度</font></font></font></span><span class="p">)</span> <span class="o">+</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">尺寸</span><span class="p">())</span>
        <span class="n">填充</font></font></font></span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">FFT 长度</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
        <span class="nb">输入</font></font></font></span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">填充</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">视图</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">扩展形状</font></font></font></span><span class="p">),</span> <span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">填充</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">填充</font></font></font></span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">]</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">填充模式</span><span class="p">)</span>
        <span class="nb">输入</font></font></font></span> <span class="o">=</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">视图</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</font></font></font></span><span class="p">[</span><span class="o">-</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">信号维度</font></font></font></span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">])</span>
    <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n">stft</span><span class="p">(</span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># 类型：忽略[已定义]</span>
        <span class="nb">输入</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="p">,</span>
        <span class="n">跳长</span><span class="p">,</span>
        <span class="n">窗长</span><span class="p">,</span>
        <span class="n">窗口</span><span class="p">,</span>
        <span class="n">标准化</span><span class="p">,</span>
        <span class="n">单向的</span><span class="p">,</span>
        <span class="n">返回复杂</span><span class="p">,</span>
        <span class="n">与窗口对齐</span><span class="p">,</span>
    <span class="p">)</span></div>


<span class="n">双谱（Inverse Short-Time Fourier Transform）</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_添加文档字符串</span><span class="p">(</span>
    <span class="n">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">短时傅里叶变换</span><span class="p">,</span>
    <span class="s2">istft(input, n_fft, 跳长=None, 窗长=None, 窗口=None, center=True, )</span>
    <span class="s2">normalized=False, onesided=None, length=None, return_complex=False) -&gt; 张量:</font></font></font></span><span class="se"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入文本翻译为简体中文为：\n</span><span class="s2">"</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">""</span>
<span class="sd">逆短时傅里叶变换。这应该与 :func:`~torch.stft` 的逆运算相对应。</span>

<span class="sd">.. 警告::</span>
<span class="sd">从版本 2.1 开始，如果未指定 :attr:`window`，将提供警告。在未来版本中，此属性将是必需的。</span>
<span class="sd">如果未指定窗口，从版本 2.1 开始将提供警告。在未来版本中，此属性将成为必需项。</span>
<span class="sd">请提供与 stft 调用中使用的相同窗口。</span>

<span class="sd">它具有相同的参数（+可选参数：attr:`length`）并且应该返回</span>
<span class="sd">原始信号的平方最小二乘估计。算法将使用 NOLA 条件（</span>
<span class="sd">非零重叠）进行检查。</span>

<span class="sd">重要参数：attr:`窗口`和：attr:`中心`的考虑，以确保所有窗口的求和在某个时间点永远不会为零。</span>
<span class="sd">具体来说，求和：math:`\sum_{t=-\infty}^{\infty} |w|^2[n-t\times hop\_length] \cancel{=} 0`。</span>
<span class="sd">由于：func:`~torch.stft`在信号末尾元素无法适应帧时将丢弃这些元素，因此，</span>

<span class="sd">信号帧的长度为：func:`~torch.stft`的长度。</span>
<span class="sd">``istft`` 可能返回比原始信号更短的信号（如果 :attr:`center` 为 False 的话可能会发生）</span>
<span class="sd">由于信号没有填充）。如果 `length` 在参数中给出并且比预期更长，</span>
<span class="sd">``istft`` 将会在返回的信号末尾填充零。</span>

<span class="sd">如果 :attr:`center` 为 ``True``，则会有填充，例如 ``'constant'``、``'reflect'`` 等。</span>
<span class="sd">左侧填充可以精确地被移除，因为它们可以计算出来，但右侧填充不能，因为没有额外的信息可以计算。</span>
<span class="sd">可以计算出来，无需额外信息。</span>

<span class="sd">例如：假设最后一个窗口是：</span>
<span class="sd">``[17, 18, 0, 0, 0]`` 与 ``[18, 0, 0, 0, 0]``</span>

<span class="sd">`:attr:`n_fft`、:attr:`hop_length`、:attr:`win_length` 都相同，这阻止了计算</span>
<span class="sd">右侧填充。这些额外值可以是零或信号的反射，因此提供</span>
<span class="sd">`:attr:`length` 可能很有用。如果 :attr:`length` 是 `None`，则将积极移除填充</span>
<span class="sd">（信号有一定损失）。</span>

<span class="sd">[1] D. W. Griffin 和 J. S. Lim, "从修改后的短时傅里叶变换中估计信号,"</span>
<span class="sd">IEEE 信号处理汇刊，第 32 卷，第 2 期，第 236-243 页，1984 年 4 月。</span>

<span class="sd">参数：</span>
<span class="sd">输入（张量）：输入张量。期望格式为 :func:`~torch.stft`，</span>
<span class="sd">输出。这是一个形状为 `(B?, N, T)` 的复数张量，</span>

<span class="sd">- `B?` 是可选的批量维度</span>
<span class="sd">- `N` 是频率样本的数量，`(n_fft // 2) + 1`</span>
<span class="sd">对于单边输入，否则 `n_fft`</span>
<span class="sd">- `T` 是帧数，对于中心化 STFT，为 `1 + length // hop_length`</span>
<span class="sd">或 `1 + (长度 - n_fft) // 跳长` 否则。</span>

<span class="sd">.. 版本变更:: 2.0</span>
<span class="sd">实数数据类型输入不再受支持。输入必须现在具有</span>
<span class="sd">复数数据类型，如 ``stft(..., return_complex=True)`` 返回的。</span>
<span class="sd">n_fft (int): 傅里叶变换的大小</span>
<span class="sd">hop_length (Optional[int]): 相邻滑动窗口帧之间的距离。</span>
<span class="sd">        (Default: ``n_fft // 4``)</span>
<span class="sd">win_length (Optional[int]): 窗口帧的大小和 STFT 滤波器。 (Default: ``n_fft``)</span>
<span class="sd">窗口（Optional[torch.Tensor]）：可选的窗口函数。</span>
<span class="sd">形状必须是 1 维且 `&lt;= n_fft`</span>
<span class="sd">（默认：``torch.ones(win_length)``）</span>
<span class="sd">center（布尔值）：是否对：attr:`input` 进行了两侧填充，以便使：math:`t`-th 帧的</span>
<span class="sd">中心位于时间：`t × hop_length`。</span>
<span class="sd">（默认：`True`）</span>
<span class="sd">标准化（布尔值）：STFT 是否进行了标准化。（默认：`False`）</span>
<span class="sd">单边（可选[布尔值]）：STFT 是否为单边。</span>
<span class="sd">（默认情况下，如果输入大小中的 `n_fft` 不等于 `fft_size`，则为 `True`）</span>
<span class="sd">长度（可选[int]）：通过信号的数量（即，）</span>
<span class="sd">原始信号长度）。默认为`(T - 1) * hop_length`。</span>
<span class="sd">居中对齐 STFT，或`n_fft + (T - 1) * hop_length`，其中`T`</span>
<span class="sd">输入帧的数量。</span>
<span class="sd">return_complex（可选[bool]）：</span>
<span class="sd">输出是否应为复数，或者输入是否应</span>
<span class="sd">假设来自实信号和窗口。</span>
<span class="sd">注意这与 `onesided=True` 不兼容。</span>
<span class="sd">（默认：`False`）</span>

<span class="sd">返回：</span>
<span class="sd">张量：原始信号的平方最小二乘估计，形状为 `(B?, length)`。</span>
<span class="sd">`B?` 是输入张量中的一个可选批处理维度。</span>
<span class="sd">"""</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">类型检查</span><span class="p">:</span>
    <span class="c1">这些 _impl 函数返回可变数量的张量作为输出，</span>
    <span class="c1"># __torch_function__; 已经完成了元组拆包，而不是进行</span>
    <span class="c1"># 由 _impl 函数的调用者完成</span>
    <span class="n">_unique_impl_out</span> <span class="o">=</span> <span class="n">任何</span>
<span class="k">否则</span><span class="p">:</span>
    <span class="n">_unique_impl_out</span> <span class="o">=</span> <span class="nb">元组</font></font></font></span><span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">]</span>


<span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一实现</span><span class="p">(</span>
    <span class="nb">输入</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">,</span>
    <span class="nb">排序</font></font></font></span><span class="p">:</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">布尔值</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">返回反向</font></font></font></span><span class="p">:</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">布尔值</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">返回计数</font></font></font></span><span class="p">:</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">布尔值</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">维度</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_unique_impl_out</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">unique(input, sorted=True, return_inverse=False, return_counts=False, dim=None) -&gt; tuple[Tensor, Tensor, Tensor]</span>

<span class="sd">返回输入张量中的唯一元素。</span>

<span class="sd">.. note:: 此函数与 :func:`torch.unique_consecutive` 不同之处在于</span>
<span class="sd">此函数还会消除非连续重复值。</span>

<span class="sd">.. 注意:: 目前在 CUDA 实现和 CPU 实现中，</span>
<span class="sd">`torch.unique` 总是在开始时对张量进行排序，无论 `sort` 参数如何。</span>
<span class="sd">排序可能会很慢，因此如果您的输入张量已经排序，建议使用</span>
<span class="sd">func:`torch.unique_consecutive`，它避免了排序。</span>

<span class="sd">参数：</span>
<span class="sd">输入（张量）：输入张量</span>
<span class="sd">排序（布尔值）：是否按升序排序唯一元素</span>
<span class="sd">在返回输出之前。</span>
<span class="sd">返回_inverse（布尔值）：是否还返回索引，表示</span>
<span class="sd">原始输入中的元素最终出现在返回的唯一列表中。</span>
<span class="sd">return_counts (bool): 是否同时返回每个唯一元素的计数</span>
<span class="sd">            element.</span>
<span class="sd">dim (int, 可选): 要操作的维度。如果 ``None``，则表示使用当前维度。</span>
<span class="sd">返回展平输入的唯一值。否则，返回每个值。</span>
<span class="sd">张量按给定维度索引被视为一个</span>
<span class="sd">要应用唯一操作的元素。请参阅示例以获取更多信息</span>
<span class="sd">详细信息。默认值：``None``</span>

<span class="sd">返回值：</span>
<span class="sd">(Tensor, Tensor (可选), Tensor (可选)): 包含张量或张量元组的张量</span>

<span class="sd">- **输出** (*Tensor*): 唯一标量元素的输出列表</span>
<span class="sd">- **inverse_indices** (*Tensor*): (可选) 如果</span>
<span class="sd">attr:`return_inverse` 为 True，则将有一个额外的</span>
<span class="sd">返回与输入相同形状的索引张量</span>
<span class="sd">表示原始输入中的元素映射到输出中的位置；</span>
<span class="sd">否则，此函数将仅返回一个张量。</span>
<span class="sd">- **counts** (*张量*)：可选的，如果</span>
<span class="sd">当 `return_counts` 为 True 时，将返回一个额外的</span>
<span class="sd">张量（与输出或 output.size(dim) 相同的形状，</span>
<span class="sd">如果指定了 dim）表示每个唯一值或张量的出现次数</span>
<span class="sd">。</span>

<span class="sd">示例::</span>

<span class="sd">        &gt;&gt;&gt; output = torch.unique(torch.tensor([1, 3, 2, 3], dtype=torch.long))</span>
<span class="sd">        &gt;&gt;&gt; output</span>
<span class="sd">        tensor([1, 2, 3])</span>

<span class="sd">&gt;&gt;&gt; 输出，逆索引 = torch.unique(</span>
<span class="sd">        ...     torch.tensor([1, 3, 2, 3], dtype=torch.long), sorted=True, return_inverse=True)</span>
<span class="sd">        &gt;&gt;&gt; output</span>
<span class="sd">        tensor([1, 2, 3])</span>
<span class="sd">        &gt;&gt;&gt; inverse_indices</span>
<span class="sd">        tensor([0, 2, 1, 2])</span>

<span class="sd">&gt;&gt;&gt; 输出，逆索引 = torch.unique(</span>
<span class="sd">        ...     torch.tensor([[1, 3], [2, 3]], dtype=torch.long), sorted=True, return_inverse=True)</span>
<span class="sd">        &gt;&gt;&gt; output</span>
<span class="sd">        tensor([1, 2, 3])</span>
<span class="sd">        &gt;&gt;&gt; inverse_indices</span>
<span class="sd">        tensor([[0, 2],</span>
<span class="sd">[[1, 2]]]</span>

<span class="sd">        &gt;&gt;&gt; a = torch.tensor([</span>
<span class="sd">        ...     [</span>
<span class="sd">        ...         [1, 1, 0, 0],</span>
<span class="sd">        ...         [1, 1, 0, 0],</span>
<span class="sd">        ...         [0, 0, 1, 1],</span>
<span class="sd">        ...     ],</span>
<span class="sd">        ...     [</span>
<span class="sd">[0, 0, 1, 1]</span>
<span class="sd">[0, 0, 1, 1]</span>
<span class="sd">[1, 1, 1, 1]</span>
<span class="sd">]</span>
<span class="sd">...</span>
<span class="sd">...[1, 1, 0, 0]</span>
<span class="sd">...[1, 1, 0, 0]</span>
<span class="sd">...[0, 0, 1, 1]</span>
<span class="sd">...</span>
<span class="sd">...</span>

<span class="sd">&gt;&gt;&gt; 如果我们调用 `torch.unique(a, dim=0)`，每个张量 `a[idx, :, :]` 都将被比较。我们可以看到 `a[0, :, :]` 和 `a[2, :, :]` 是匹配的</span>
<span class="sd">&gt;&gt;&gt; 将会进行比较。我们可以看到 `a[0, :, :]` 和 `a[2, :, :]` 匹配</span>
<span class="sd">&gt;&gt;&gt; # 每个都会被删除，所以其中一个将被移除。</span>
<span class="sd">        &gt;&gt;&gt; (a[0, :, :] == a[2, :, :]).all()</span>
<span class="sd">        tensor(True)</span>
<span class="sd">        &gt;&gt;&gt; a_unique_dim0 = torch.unique(a, dim=0)</span>
<span class="sd">        &gt;&gt;&gt; a_unique_dim0</span>
<span class="sd">        tensor([[[0, 0, 1, 1],</span>
<span class="sd">                 [0, 0, 1, 1],</span>
<span class="sd">                 [1, 1, 1, 1]],</span>
<span class="sd">                [[1, 1, 0, 0],</span>
<span class="sd">                 [1, 1, 0, 0],</span>
<span class="sd">[0, 0, 1, 1]]</span>

<span class="sd">&gt;&gt;&gt; # 注意哪些子张量从 `a` 与子张量从</span>
<span class="sd">        &gt;&gt;&gt; # `a_unique_dim0`:</span>
<span class="sd">        &gt;&gt;&gt; (a_unique_dim0[0, :, :] == a[1, :, :]).all()</span>
<span class="sd">        tensor(True)</span>
<span class="sd">        &gt;&gt;&gt; (a_unique_dim0[1, :, :] == a[0, :, :]).all()</span>
<span class="sd">        tensor(True)</span>

<span class="sd">&gt;&gt;&gt; 对于 `torch.unique(a, dim=1)`，每个张量 `a[:, idx, :]` 都会被比较。</span>
<span class="sd">&gt;&gt;&gt; `a[:, 0, :]` 和 `a[:, 1, :]` 相匹配，所以其中一个将被移除。</span>
<span class="sd">&gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; (a[:, 0, :] == a[:, 1, :]).all()</span>
<span class="sd">        tensor(True)</span>
<span class="sd">        &gt;&gt;&gt; torch.unique(a, dim=1)</span>
<span class="sd">        tensor([[[0, 0, 1, 1],</span>
<span class="sd">[[1, 1, 0, 0]]</span>
<span class="sd">[[1, 1, 1, 1]]</span>
<span class="sd">[[0, 0, 1, 1]]</span>
<span class="sd">[[0, 0, 1, 1]]</span>
<span class="sd">                 [1, 1, 0, 0]]])</span>

<span class="sd">对于 `torch.unique(a, dim=2)`，张量 `a[:, :, idx]` 进行比较。</span>
<span class="sd">`a[:, :, 0]` 和 `a[:, :, 1]` 相匹配。同时，`a[:, :, 2]` 和</span>
<span class="sd">&gt;&gt;&gt; `a[:, :, 3]`彼此匹配得也很好。所以在这种情况下，两个中的</span>
<span class="sd">&gt;&gt;&gt; # 将移除子张量。</span>
<span class="sd">        &gt;&gt;&gt; (a[:, :, 0] == a[:, :, 1]).all()</span>
<span class="sd">        tensor(True)</span>
<span class="sd">        &gt;&gt;&gt; (a[:, :, 2] == a[:, :, 3]).all()</span>
<span class="sd">        tensor(True)</span>
<span class="sd">        &gt;&gt;&gt; torch.unique(a, dim=2)</span>
<span class="sd">        tensor([[[0, 1],</span>
<span class="sd">                 [0, 1],</span>
<span class="sd">[1, 0]</span>
<span class="sd">[[1, 0]]</span>
<span class="sd">[1, 0]</span>
<span class="sd">[1, 1]</span>
<span class="sd">[[0, 1]]</span>
<span class="sd">[[0, 1]]</span>
<span class="sd">[[1, 0]]</span>
<span class="sd">    """</span>
    <span class="k">如果</font></font></font></span> <span class="n">has_torch_function_unary</span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</span><span class="p">):</span>
        <span class="k">返回</span> <span class="n">handle_torch_function</span><span class="p">(</span>
            <span class="n">独特</span><span class="p">,</span>
            <span class="p">(</span><span class="nb">输入</span><span class="p">,),</span>
            <span class="nb">输入</span><span class="p">,</span>
            <span class="nb">排序</font></font></font></span><span class="o">=</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">排序</span><span class="p">,</span>
            <span class="n">返回反向</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</span><span class="p">,</span>
            <span class="n">返回计数</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</span><span class="p">,</span>
            <span class="n">维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="ow">not</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
        <span class="n">输出</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">反向索引</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">计数</font></font></font></span> <span class="o">=</span> <span class="n">_VF</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">独特维度</span><span class="p">(</span>
            <span class="nb">输入</span><span class="p">,</span>
            <span class="n">维度</span><span class="p">,</span>
            <span class="nb">排序</font></font></font></span><span class="o">=</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">排序</span><span class="p">,</span>
            <span class="n">返回反向</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</span><span class="p">,</span>
            <span class="n">返回计数</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">否则</span><span class="p">:</span>
        <span class="n">输出</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">反向索引</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">计数</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</span><span class="o">.</span><span class="n">_unique2</span><span class="p">(</span>
            <span class="nb">输入</span><span class="p">,</span>
            <span class="nb">排序</font></font></font></span><span class="o">=</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">排序</span><span class="p">,</span>
            <span class="n">返回反向</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</span><span class="p">,</span>
            <span class="n">返回计数</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输出</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">反向索引</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">计数</span>


<span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一连续实现</span><span class="p">(</span>
    <span class="nb">输入</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">,</span>
    <span class="n">返回反向</font></font></font></span><span class="p">:</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">布尔值</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">返回计数</font></font></font></span><span class="p">:</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">布尔值</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">维度</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">唯一实现输出</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">消除每个连续等效元素组中除第一个元素之外的所有元素。</span>

<span class="sd">.. 注意:: 此函数与 :func:`torch.unique` 在意义上有所不同</span>
<span class="sd">仅消除连续重复的值。此语义类似于 `std::unique`</span>
<span class="sd">在 C++中</span>

<span class="sd">参数：</span>
<span class="sd">输入（张量）：输入张量</span>
<span class="sd">return_inverse (bool): 是否同时返回原始输入中元素在返回的唯一列表中的索引</span>
<span class="sd">            elements in the original input ended up in the returned unique list.</span>
<span class="sd">return_counts (bool): 是否同时返回每个唯一元素的计数</span>
<span class="sd">            element.</span>
<span class="sd">dim (int): 应用唯一的维度。如果为 ``None``，则返回展平输入的唯一值。默认：``None``</span>
<span class="sd">default: ``None``</span>

<span class="sd">返回值：</span>
<span class="sd">(Tensor, Tensor (可选), Tensor (可选)): 包含张量或张量元组的张量</span>

<span class="sd">- **输出** (*Tensor*): 唯一标量元素的输出列表</span>
<span class="sd">- **inverse_indices** (*Tensor*): (可选) 如果</span>
<span class="sd">attr:`return_inverse` 为 True，则将有一个额外的</span>
<span class="sd">返回与输入相同形状的索引张量</span>
<span class="sd">表示原始输入中的元素映射到输出中的位置；</span>
<span class="sd">否则，此函数将仅返回一个张量。</span>
<span class="sd">- **counts** (*张量*)：可选的，如果</span>
<span class="sd">当 `return_counts` 为 True 时，将返回一个额外的</span>
<span class="sd">张量（与输出或 output.size(dim) 相同的形状，</span>
<span class="sd">如果指定了 dim）表示每个唯一值或张量的出现次数</span>
<span class="sd">。</span>

<span class="sd">示例::</span>

<span class="sd">        &gt;&gt;&gt; x = torch.tensor([1, 1, 2, 2, 3, 1, 1, 2])</span>
<span class="sd">        &gt;&gt;&gt; output = torch.unique_consecutive(x)</span>
<span class="sd">        &gt;&gt;&gt; output</span>
<span class="sd">        tensor([1, 2, 3, 1, 2])</span>

<span class="sd">        &gt;&gt;&gt; output, inverse_indices = torch.unique_consecutive(x, return_inverse=True)</span>
<span class="sd">        &gt;&gt;&gt; output</span>
<span class="sd">        tensor([1, 2, 3, 1, 2])</span>
<span class="sd">        &gt;&gt;&gt; inverse_indices</span>
<span class="sd">        tensor([0, 0, 1, 1, 2, 3, 3, 4])</span>

<span class="sd">        &gt;&gt;&gt; output, counts = torch.unique_consecutive(x, return_counts=True)</span>
<span class="sd">        &gt;&gt;&gt; output</span>
<span class="sd">        tensor([1, 2, 3, 1, 2])</span>
<span class="sd">&gt;&gt;&gt; 计数</span>
<span class="sd">        tensor([2, 2, 1, 2, 1])</span>
<span class="sd">    """</span>
    <span class="k">如果</font></font></font></span> <span class="n">has_torch_function_unary</span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</span><span class="p">):</span>
        <span class="k">返回</span> <span class="n">handle_torch_function</span><span class="p">(</span>
            <span class="n">唯一连续</span><span class="p">,</span>
            <span class="p">(</span><span class="nb">输入</span><span class="p">,),</span>
            <span class="nb">输入</span><span class="p">,</span>
            <span class="n">返回反向</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</span><span class="p">,</span>
            <span class="n">返回计数</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</span><span class="p">,</span>
            <span class="n">维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">输出</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">反向索引</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">计数</font></font></font></span> <span class="o">=</span> <span class="n">_VF</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">唯一连续</font></font></font></span><span class="p">(</span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># 类型：忽略[已定义]</span>
        <span class="nb">输入</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span>
    <span class="p">)</span>
    <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输出</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">反向索引</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">计数</span>


<span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</span><span class="p">(</span>
    <span class="nb">输入</span><span class="p">,</span>
    <span class="nb">排序</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">返回反向</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">返回计数</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">维度</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
<span class="p">):</span>
    <span class="c1">(Tensor, bool, bool, bool, Optional[int]) -&gt; tuple[Tensor, Tensor]</span>

    <span class="k">如果</font></font></font></span> <span class="n">has_torch_function_unary</span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</span><span class="p">):</span>
        <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一实现</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">排序</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">)</span>

    <span class="n">输出</font></font></font></span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">计数</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一实现</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">排序</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">)</span>
    <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输出</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">计数</span>


<span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_返回输出</span><span class="p">(</span>
    <span class="nb">输入</span><span class="p">,</span>
    <span class="nb">排序</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">返回反向</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">返回计数</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">维度</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
<span class="p">):</span>
    <span class="c1"># 类型: (张量, 布尔值, 布尔值, 布尔值, 可选[int]) -&gt; 张量</span>

    <span class="k">如果</font></font></font></span> <span class="n">has_torch_function_unary</span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</span><span class="p">):</span>
        <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一实现</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">排序</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">)</span>

    <span class="n">输出</font></font></font></span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一实现</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">排序</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">)</span>
    <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输出</span>


<span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回逆序</span><span class="p">(</span>
    <span class="nb">输入</span><span class="p">,</span>
    <span class="nb">排序</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">返回反向</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">返回计数</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">维度</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
<span class="p">):</span>
    <span class="c1">(Tensor, bool, bool, bool, Optional[int]) -&gt; tuple[Tensor, Tensor]</span>

    <span class="k">如果</font></font></font></span> <span class="n">has_torch_function_unary</span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</span><span class="p">):</span>
        <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一实现</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">排序</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">)</span>

    <span class="n">输出</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">反向索引</font></font></font></span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一实现</span><span class="p">(</span>
        <span class="nb">输入</font></font></font></span><span class="p">,</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">排序</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span>
    <span class="p">)</span>
    <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输出</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">反向索引</span>


<span class="n">_返回逆序为假</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">布尔分发</span><span class="p">(</span>
    <span class="n">参数名称</font></font></font></span><span class="o">=</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"返回计数"</span><span class="p">,</span>
    <span class="n">索引参数</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">默认</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">如果为真</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</span><span class="p">,</span>
    <span class="n">如果为假</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_返回输出</span><span class="p">,</span>
    <span class="n">模块名称</span><span class="o">=</span><span class="vm">__name__</span><span class="p">,</span>
    <span class="n">函数名</font></font></font></span><span class="o">=</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"唯一"</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">返回逆序真</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">布尔分发</span><span class="p">(</span>
    <span class="n">参数名称</font></font></font></span><span class="o">=</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"返回计数"</span><span class="p">,</span>
    <span class="n">索引参数</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">默认</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">如果为真</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一实现</span><span class="p">,</span>
    <span class="n">如果为假</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回逆序</span><span class="p">,</span>
    <span class="n">模块名称</span><span class="o">=</span><span class="vm">__name__</span><span class="p">,</span>
    <span class="n">函数名</font></font></font></span><span class="o">=</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"唯一"</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># unique 的返回类型取决于`return_inverse`和`return_counts`，因此为了</span>
<span class="c1"># 在 TorchScript 中解决输出类型，我们需要静态地知道这两个参数的值</span>

<span class="n">唯一的</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">布尔分发</span><span class="p">(</span>
    <span class="n">参数名称</font></font></font></span><span class="o">=</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回逆序</span><span class="p">,</span>
    <span class="n">索引参数</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">默认</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">如果为真</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_返回逆序为真</span><span class="p">,</span>
    <span class="n">如果为假</span><span class="o">=</span><span class="n">_return_inverse_false</span><span class="p">,</span>
    <span class="n">模块名称</span><span class="o">=</span><span class="vm">__name__</span><span class="p">,</span>
    <span class="n">函数名</font></font></font></span><span class="o">=</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"唯一"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">独特</font></font></font></span><span class="o">.</span><span class="vm"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">__文档__</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一实现</font></font></font></span><span class="o">.</span><span class="vm"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">__文档__</span>


<span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_连续返回计数</span><span class="p">(</span>
    <span class="nb">输入</span><span class="p">,</span>
    <span class="n">返回反向</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">返回计数</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">维度</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
<span class="p">):</span>
    <span class="c1"># 类型: (Tensor, bool, bool, Optional[int]) -&gt; tuple[Tensor, Tensor]</span>

    <span class="k">如果</font></font></font></span> <span class="n">has_torch_function_unary</span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</span><span class="p">):</span>
        <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一连续实现</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">)</span>

    <span class="n">输出</font></font></font></span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">计数</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一连续实现</span><span class="p">(</span>
        <span class="nb">输入</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span>
    <span class="p">)</span>
    <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输出</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">计数</span>


<span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">连续返回输出</span><span class="p">(</span>
    <span class="nb">输入</span><span class="p">,</span>
    <span class="n">返回反向</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">返回计数</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">维度</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
<span class="p">):</span>
    <span class="c1">(张量，布尔值，布尔值，可选[int]) -&gt; 张量</span>

    <span class="k">如果</font></font></font></span> <span class="n">has_torch_function_unary</span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</span><span class="p">):</span>
        <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一连续实现</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">)</span>

    <span class="n">输出</font></font></font></span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一连续实现</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">)</span>
    <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输出</span>


<span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_连续返回倒数</span><span class="p">(</span>
    <span class="nb">输入</span><span class="p">,</span>
    <span class="n">返回反向</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">返回计数</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">维度</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
<span class="p">):</span>
    <span class="c1"># 类型: (Tensor, bool, bool, Optional[int]) -&gt; tuple[Tensor, Tensor]</span>

    <span class="k">如果</font></font></font></span> <span class="n">has_torch_function_unary</span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</span><span class="p">):</span>
        <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一连续实现</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">)</span>

    <span class="n">输出</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">反向索引</font></font></font></span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一连续实现</span><span class="p">(</span>
        <span class="nb">输入</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回反向</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回计数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span>
    <span class="p">)</span>
    <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输出</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">反向索引</span>


<span class="n">连续返回逆序为假</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">布尔分发</span><span class="p">(</span>
    <span class="n">参数名称</font></font></font></span><span class="o">=</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"返回计数"</span><span class="p">,</span>
    <span class="n">索引参数</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">默认</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">如果为真</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_连续返回计数</span><span class="p">,</span>
    <span class="n">如果为假</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">连续返回输出</span><span class="p">,</span>
    <span class="n">模块名称</span><span class="o">=</span><span class="vm">__name__</span><span class="p">,</span>
    <span class="n">函数名</font></font></font></span><span class="o">=</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">独特连续</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">_连续返回逆真</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">布尔分发</span><span class="p">(</span>
    <span class="n">参数名称</font></font></font></span><span class="o">=</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"返回计数"</span><span class="p">,</span>
    <span class="n">索引参数</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">默认</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">如果为真</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一连续实现</span><span class="p">,</span>
    <span class="n">如果为假</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_连续返回倒数</span><span class="p">,</span>
    <span class="n">模块名称</span><span class="o">=</span><span class="vm">__name__</span><span class="p">,</span>
    <span class="n">函数名</font></font></font></span><span class="o">=</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">独特连续</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># unique 的返回类型取决于`return_inverse`和`return_counts`，因此为了</span>
<span class="c1"># 在 TorchScript 中解决输出类型，我们需要静态地知道这两个参数的值</span>

<span class="n">独一无二连续</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">布尔分发</span><span class="p">(</span>
    <span class="n">参数名称</font></font></font></span><span class="o">=</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">返回逆序</span><span class="p">,</span>
    <span class="n">索引参数</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">默认</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">如果为真</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_连续返回逆真</span><span class="p">,</span>
    <span class="n">如果为假</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_连续返回逆序为假</span><span class="p">,</span>
    <span class="n">模块名称</span><span class="o">=</span><span class="vm">__name__</span><span class="p">,</span>
    <span class="n">函数名</font></font></font></span><span class="o">=</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">独特连续</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">唯一连续</font></font></font></span><span class="o">.</span><span class="vm"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">__文档__</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_唯一连续实现</font></font></font></span><span class="o">.</span><span class="vm"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">__文档__</span>

<span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">类型检查</span><span class="p">:</span>
    <span class="k">通过</span>
    <span class="c1">没有好的方法使用这种类型注解而不破坏即时编译（JIT）</span>
    <span class="c1">因此，为了 mypy 现在留为未类型化</span>
<span class="k">否则</span><span class="p">:</span>

    <span class="nd">@overload</span>
    <span class="k">定义</span> <span class="nf">tensordot</span><span class="p">(</span>
        <span class="n">a</span><span class="p">,</span>
        <span class="n">b</span><span class="p">,</span>
        <span class="n">维数</font></font></font></span><span class="p">:</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">整型</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">出</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">]</span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">通过</span>

    <span class="nd">@overload</span>
    <span class="k">定义</span> <span class="nf">tensordot</span><span class="p">(</span>  <span class="c1"># noqa: F811</span>
        <span class="n">a</span><span class="p">,</span>
        <span class="n">b</span><span class="p">,</span>
        <span class="n">维数</font></font></font></span><span class="p">:</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">元组</font></font></font></span><span class="p">[</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</font></font></font></span><span class="p">[</span><span class="nb">int</span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">]</font></font></font></span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
        <span class="n">出</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">]</span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">通过</span>

    <span class="nd">@overload</span>
    <span class="k">定义</span> <span class="nf">tensordot</span><span class="p">(</span>  <span class="c1"># noqa: F811</span>
        <span class="n">a</span><span class="p">,</span>
        <span class="n">b</span><span class="p">,</span>
        <span class="n">维数</font></font></font></span><span class="p">:</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</font></font></font></span><span class="p">[</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
        <span class="n">出</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">]</span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">通过</span>

    <span class="nd">@overload</span>
    <span class="k">定义</span> <span class="nf">tensordot</span><span class="p">(</span>  <span class="c1"># noqa: F811</span>
        <span class="n">a</span><span class="p">,</span>
        <span class="n">b</span><span class="p">,</span>
        <span class="n">维数</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">,</span>
        <span class="n">出</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">]</span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">通过</span>


<div class="viewcode-block" id="tensordot"><a class="viewcode-back" href="../../generated/torch.tensordot.html#torch.tensordot">[文档]</font></font></font></a><span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">定义</span> <span class="nf">tensordot</span><span class="p">(</span>  <span class="c1"># noqa: F811</span>
    <span class="n">a</span><span class="p">,</span>
    <span class="n">b</span><span class="p">,</span>
    <span class="n">维数</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">出</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">可选</font></font></font></span><span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">]</span> <span class="o">=</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">在多个维度上返回 a 和 b 的收缩</span>

<span class="sd">attr:`tensordot` 实现了广义矩阵乘法。</span>

<span class="sd">参数：</span>
<span class="sd">a (张量): 要收缩的左张量</span>
<span class="sd">b (张量): 要收缩的右张量</span>
<span class="sd">dims（int 或包含两个列表或列表的元组或列表列表的 Tensor）：维度数</span>
<span class="sd">合约或显式列表维度用于：attr:`a`和</span>
<span class="sd">attr:`b`分别</span>

<span class="sd">当使用非负整数参数：attr:`dims` = :math:`d`时，</span>
<span class="sd">a 和 b 的维度数分别为 m 和 n，</span>
<span class="sd">分别，:func:`~torch.tensordot` 函数计算</span>

<span class="sd">    .. math::</span>
<span class="sd">        r_{i_0,...,i_{m-d}, i_d,...,i_n}</span>
<span class="sd">          = \sum_{k_0,...,k_{d-1}} a_{i_0,...,i_{m-d},k_0,...,k_{d-1}} \times b_{k_0,...,k_{d-1}, i_d,...,i_n}.</span>

<span class="sd">当以列表形式的 :attr:`dims` 调用时，将给出的大小将替代 :attr:`a` 的最后 :math:`d` 个和 :attr:`b` 的前 :math:`d` 个。</span>
<span class="sd">在这些维度中大小必须匹配，但 :func:`~torch.tensordot` 将处理广播。</span>
<span class="sd">这些维度中大小必须匹配，但 :func:`~torch.tensordot` 将处理广播。</span>
<span class="sd">尺寸。</span>

<span class="sd">示例：</span>

<span class="sd">        &gt;&gt;&gt; a = torch.arange(60.).reshape(3, 4, 5)</span>
<span class="sd">        &gt;&gt;&gt; b = torch.arange(24.).reshape(4, 3, 2)</span>
<span class="sd">        &gt;&gt;&gt; torch.tensordot(a, b, dims=([1, 0], [0, 1]))</span>
<span class="sd">        tensor([[4400., 4730.],</span>
<span class="sd">                [4532., 4874.],</span>
<span class="sd">                [4664., 5018.],</span>
<span class="sd">[4796., 5162.]</span>
<span class="sd">[4928., 5306.]</span>

<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(env:TORCH_DOCTEST_CUDA)</span>
<span class="sd">        &gt;&gt;&gt; a = torch.randn(3, 4, 5, device='cuda')</span>
<span class="sd">        &gt;&gt;&gt; b = torch.randn(4, 5, 6, device='cuda')</span>
<span class="sd">        &gt;&gt;&gt; c = torch.tensordot(a, b, dims=2).cpu()</span>
<span class="sd">        tensor([[ 8.3504, -2.5436,  6.2922,  2.7556, -1.0732,  3.2741],</span>
<span class="sd">                [ 3.3161,  0.0704,  5.0187, -0.4079, -4.3126,  4.8744],</span>
<span class="sd">[0.8223, 3.9445, 3.2168, -0.2400, 3.4117, 1.7780]]</span>

<span class="sd">        &gt;&gt;&gt; a = torch.randn(3, 5, 4, 6)</span>
<span class="sd">        &gt;&gt;&gt; b = torch.randn(6, 4, 5, 3)</span>
<span class="sd">        &gt;&gt;&gt; torch.tensordot(a, b, dims=([2, 1, 3], [1, 2, 0]))</span>
<span class="sd">        tensor([[  7.7193,  -2.4867, -10.3204],</span>
<span class="sd">                [  1.5513, -14.4737,  -6.5113],</span>
<span class="sd">                [ -0.2850,   4.2573,  -3.5997]])</span>
<span class="sd">    """</span>
    <span class="k">如果</span> <span class="n">has_torch_function_variadic</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">返回</font></font></font></span> <span class="n">handle_torch_function</span><span class="p">(</span><span class="n">tensordot</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</span><span class="p">)</span>

    <span class="k">如果</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">不</font></font></font></span> <span class="nb">isinstance</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</font></font></font></span><span class="p">,</span> <span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">元组</font></font></font></span><span class="p">,</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</span><span class="o">.</span><span class="n">SymInt</span><span class="p">)):</span>
        <span class="k">抛出</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">"tensordot 期望维度为 int 或"</span>
            <span class="o">+</span> <span class="s2">"tuple[列表[int], 列表[int]]或"</span>
            <span class="o">+</span> <span class="s2">"包含两个列表的 list[list[int]]，但得到"</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">"dims="</font></font></font></span><span class="si">{</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</span><span class="si">}</span><span class="s2">"</span>
        <span class="p">)</span>

    <span class="n">次元_a</font></font></font></span><span class="p">:</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</font></font></font></span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入文本为空，请提供需要翻译的文本</span>
    <span class="n">次元_b</font></font></font></span><span class="p">:</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</font></font></font></span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入文本为空，请提供需要翻译的文本</span>

    <span class="k">如果</font></font></font></span> <span class="nb">isinstance</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</font></font></font></span><span class="p">,</span> <span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">元组</font></font></font></span><span class="p">,</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</span><span class="p">)):</span>
        <span class="n">次元_a</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">模块_b</span> <span class="o">=</span> <span class="n">dims</span>

    <span class="k">如果</font></font></font></span> <span class="nb">isinstance</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">):</span>
        <span class="n">元素数量</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">元素数量</span><span class="p">()</span>
        <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">元素数量</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">断言</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">尺寸</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
            <span class="n">dims_a</span> <span class="o">=</span> <span class="n">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">算子</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">标注</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</font></font></font></span><span class="p">[</span><span class="nb">int</span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">]</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</font></font></font></span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">转列表</span><span class="p">())</span>
            <span class="n">模块_b</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">算子</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">标注</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</font></font></font></span><span class="p">[</span><span class="nb">int</span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">]</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</font></font></font></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">转列表</span><span class="p">())</span>
        <span class="k">否则</span><span class="p">:</span>
            <span class="n">dims_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">维数</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">项目</span><span class="p">())</span>
            <span class="k">如果</span> <span class="n">dims_val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">抛出</font></font></font></span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"tensordot 期望 dims &gt;= 0，但得到 dims="</font></font></font></span><span class="si">{</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">dims_a</span> <span class="o">=</span> <span class="nb">列表</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">范围</span><span class="p">(</span><span class="o">-</span><span class="n">dims_val</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="n">dims_b</span> <span class="o">=</span> <span class="nb">列表</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">范围</span><span class="p">(</span><span class="n">dims_val</span><span class="p">))</span>

    <span class="k">如果</font></font></font></span> <span class="nb">isinstance</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</font></font></font></span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</span><span class="o">.</span><span class="n">SymInt</span><span class="p">)):</span>
        <span class="k">如果</span> <span class="n">dims</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">抛出</font></font></font></span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"tensordot 期望 dims &gt;= 0，但得到 dims="</font></font></font></span><span class="si">{</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">如果</font></font></font></span> <span class="n">dims</span> <span class="o">&gt;</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">最小值</font></font></font></span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span><span class="p">(),</span> <span class="n">b</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">()):</span>
            <span class="k">抛出</font></font></font></span> <span class="ne"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">运行时错误</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">tensordot 期望维度小于 ndim_a 或 ndim_b，但得到了维度=</font></font></font></span><span class="si">{</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</span><span class="si">}</span><span class="s2">"</span>
            <span class="p">)</span>
        <span class="n">dims_a</span> <span class="o">=</span> <span class="nb">列表</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">范围</font></font></font></span><span class="p">(</span><span class="o">-</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">模块_b</font></font></font></span> <span class="o">=</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">范围</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</span><span class="p">))</span>

    <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
        <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n">tensordot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">次元_a</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">次元_b</font></font></font></span><span class="p">)</span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># 类型：忽略[已定义]</span>
    <span class="k">否则</span><span class="p">:</span>
        <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n">tensordot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">次元_a</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">次元_b</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输出</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</span><span class="p">)</span>  <span class="c1"># type: ignore[attr-defined]</span></div>


<div class="viewcode-block" id="cartesian_prod"><font class=" " lang="zh-CN"><br hidden=""><font class="    "><font class="  ">[docs]def 笛卡尔积(*tensors: Tensor) -&gt; Tensor:
"""对给定的张量序列进行笛卡尔积。其行为类似于
Python 的`itertools.product`。

Args:
*张量：任意数量的 1 维张量。

返回：
张量：将所有输入张量转换为列表的等价张量，
然后对这些列表执行 `itertools.product`，最后将结果列表转换为
转换为张量。

示例::

&gt;&gt;&gt; 导入 itertools
&gt;&gt;&gt; a = [1, 2, 3]
&gt;&gt;&gt; b = [4, 5]
&gt;&gt;&gt; list(itertools.product(a, b))
[(1, 4), (1, 5), (2, 4), (2, 5), (3, 4), (3, 5)]
&gt;&gt;&gt; tensor_a = torch.tensor(a)
&gt;&gt;&gt; tensor_b = torch.tensor(b)
&gt;&gt;&gt; torch.cartesian_prod(tensor_a, tensor_b)
tensor([[1, 4],
[1, 5],
[2, 4]
[2, 5]
[3, 4]
[3, 5]
"""
# 此包装器存在以支持可变参数。
if has_torch_function(tensors):
return handle_torch_function(cartesian_prod, tensors, *tensors)
return _VF.cartesian_prod(tensors)  # 忽略未定义的属性</font></font></font></div>


<div class="viewcode-block" id="block_diag"><font class=" " lang="zh-CN"><br hidden=""><font class="    "><font class="  ">[文档]def block_diag(*tensors):
创建由提供的张量组成的分块对角矩阵。

Args:
张量：一个或多个具有 0、1 或 2 维度的张量。

返回：
张量：一个二维张量，其中所有输入张量按顺序排列
按顺序排列，使它们的左上角和右下角
对角相邻。其他所有元素设置为 0。

示例::

&gt;&gt;&gt; 导入 torch
&gt;&gt;&gt; A = torch.tensor([[0, 1], [1, 0]])
&gt;&gt;&gt; B = torch.tensor([[3, 4, 5], [6, 7, 8]])
&gt;&gt;&gt; C = torch.tensor(7)
&gt;&gt;&gt; D = torch.tensor([1, 2, 3])
&gt;&gt;&gt; E = torch.tensor([[4], [5], [6]])
&gt;&gt;&gt; torch.block_diag(A, B, C, D, E)
tensor([[0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 3, 4, 5, 0, 0, 0, 0, 0],
[0, 0, 6, 7, 8, 0, 0, 0, 0, 0]
[0, 0, 0, 0, 0, 7, 0, 0, 0, 0]
[0, 0, 0, 0, 0, 0, 1, 2, 3, 0]
[0, 0, 0, 0, 0, 0, 0, 0, 0, 4]
[0, 0, 0, 0, 0, 0, 0, 0, 0, 5]
[0, 0, 0, 0, 0, 0, 0, 0, 0, 6]
""
# This wrapper exists to support variadic args.
if has_torch_function(tensors):
return handle_torch_function(block_diag, tensors, *tensors)
return torch._C._VariableFunctions.block_diag(tensors)  # type: ignore[attr-defined]</font></font></font></div>


<div class="viewcode-block" id="cdist"><a class="viewcode-back" href="../../generated/torch.cdist.html#torch.cdist">[文档]</font></font></font></a><span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">定义</font></font></font></span> <span class="nf">cdist</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">计算模式</font></font></font></span><span class="o">=</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"如有必要，使用 mm 计算欧几里得距离"</span><span class="p">):</span>
    <span class="c1"># 类型：(Tensor, Tensor, float, str) -&gt; (Tensor)</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">"计算两个行向量集合中每对之间的 p 范数距离。"</span>

<span class="sd">参数：</span>
<span class="sd">x1 (Tensor)：形状为 :math:`B \times P \times M` 的输入张量。</span>
<span class="sd">x2 (Tensor)：输入张量，形状为 :math:`B \times R \times M`。</span>
<span class="sd">p：计算每个向量对之间的 p-范数距离的 p 值</span>
<span class="sd">math:`\in [0, \infty]`。</span>
<span class="sd">compute_mode：</span>
<span class="sd">'当需要时使用矩阵乘法计算欧几里得距离（p = 2）如果 P &gt; 25 或 R &gt; 25'</span>
<span class="sd">欧几里得距离（p = 2）</span>
<span class="sd">'始终使用矩阵乘法计算欧几里得距离（p = 2）'</span>
<span class="sd">欧几里得距离（p = 2）</span>
<span class="sd">不使用 mm 计算欧几里得距离</span>
<span class="sd">欧几里得距离（p = 2）</span>
<span class="sd">默认：如果需要，则使用毫米计算欧几里得距离。</span>

<span class="sd">如果 x1 的形状为 :math:`B \times P \times M`，而 x2 的形状为 :math:`B \times R \times M`，那么：</span>
<span class="sd">输出将具有形状：`B × P × R`。</span>

<span class="sd">此函数等价于 `scipy.spatial.distance.cdist(input,'minkowski', p=p)`。</span>
<span class="sd">当 :math:`p ∈ (0, ∞)` 时。当 :math:`p = 0` 时，它等价于</span>
<span class="sd">`scipy.spatial.distance.cdist(input, 'hamming') * M`。当 :math:`p = ∞` 时，最近的</span>
<span class="sd">scipy 函数是`scipy.spatial.distance.cdist(xn, lambda x, y: np.abs(x - y).max())`。</span>

<span class="sd">示例：</span>

<span class="sd">        &gt;&gt;&gt; a = torch.tensor([[0.9041, 0.0196], [-0.3108, -2.4423], [-0.4821, 1.059]])</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        tensor([[ 0.9041,  0.0196],</span>
<span class="sd">[-0.3108, -2.4423]</span>
<span class="sd">[-0.4821, 1.0590]</span>
<span class="sd">        &gt;&gt;&gt; b = torch.tensor([[-2.1763, -0.4713], [-0.6986, 1.3702]])</span>
<span class="sd">        &gt;&gt;&gt; b</span>
<span class="sd">        tensor([[-2.1763, -0.4713],</span>
<span class="sd">                [-0.6986,  1.3702]])</span>
<span class="sd">        &gt;&gt;&gt; torch.cdist(a, b, p=2)</span>
<span class="sd">        tensor([[3.1193, 2.0959],</span>
<span class="sd">[2.7138, 3.8322]</span>
<span class="sd">[2.2830, 0.3791]</span>
<span class="sd">    """</span>
    <span class="k">如果</span> <span class="n">has_torch_function_variadic</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
        <span class="k">返回</span> <span class="n">handle_torch_function</span><span class="p">(</span>
            <span class="n">cdist</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">计算模式</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">计算模式</span>
        <span class="p">)</span>
    <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">计算模式</font></font></font></span> <span class="o">==</span> <span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"如有必要，使用 mm 计算欧几里得距离"</span><span class="p">:</span>
        <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</font></font></font></span><span class="p">)</span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># 类型：忽略[已定义]</span>
    <span class="k">elif</span> <span class="n">计算模式</font></font></font></span> <span class="o">==</span> <span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">使用 mm 计算欧几里得距离</span><span class="p">:</span>
        <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># 类型：忽略[已定义]</span>
    <span class="k">elif</span> <span class="n">计算模式</font></font></font></span> <span class="o">==</span> <span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">不使用 mm 计算欧几里得距离</span><span class="p">:</span>
        <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># 类型：忽略[已定义]</span>
    <span class="k">否则</span><span class="p">:</span>
        <span class="k">抛出</font></font></font></span> <span class="ne"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">值错误</font></font></font></span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">计算模式</font></font></font></span><span class="si">}</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"compute_mode"不是一个有效的值</span><span class="p">)</span></div>


<div class="viewcode-block" id="atleast_1d"><font class=" " lang="zh-CN"><br hidden=""><font class="    "><font class="  ">[文档]def 至少_1d(*tensors):
r"""
返回每个输入张量的 1 维视图，其中零维为 0。
输入张量如果有一维或多维，则按原样返回。

Args:
输入 (Tensor 或 Tensor 列表)

返回:
输出 (Tensor 或 Tensor 元组)

示例::

&gt;&gt;&gt; x = torch.arange(2)
&gt;&gt;&gt; x
tensor([0, 1])
&gt;&gt;&gt; torch.atleast_1d(x)
tensor([0, 1])
&gt;&gt;&gt; x = torch.tensor(1.)
&gt;&gt;&gt; x
tensor(1.)
&gt;&gt;&gt; torch.atleast_1d(x)
tensor([1.])
&gt;&gt;&gt; x = torch.tensor(0.5)
&gt;&gt;&gt; y = torch.tensor(1.)
&gt;&gt;&gt; torch.atleast_1d((x, y))
(tensor([0.5000]), tensor([1.]))
"""
# This wrapper exists to support variadic args.
如果有 torch_function(tensors):
返回 handle_torch_function(atleast_1d, tensors, *tensors)
如果 tensors 的长度等于 1:
tensors = tensors[0]
return _VF.atleast_1d(tensors)  # type: ignore[attr-defined]</font></font></font></div>


<div class="viewcode-block" id="atleast_2d"><font class=" " lang="zh-CN"><br hidden=""><font class="    "><font class="  ">[文档]def 至少_2d(*tensors):
r"""
返回每个输入张量的二维视图，零维度的张量保持不变。
输入张量如果有两个或更多维度，则直接返回。

Args:
输入 (Tensor 或 Tensor 列表)

返回:
输出 (Tensor 或 Tensor 元组)

示例::

&gt;&gt;&gt; x = torch.tensor(1.)
&gt;&gt;&gt; x
tensor(1.)
&gt;&gt;&gt; torch.atleast_2d(x)
&gt;&gt;&gt; tensor([[1.]])
&gt;&gt;&gt; x = torch.arange(4).view(2, 2)
&gt;&gt;&gt; x
tensor([[0, 1],
[2, 3]])
&gt;&gt;&gt; torch.atleast_2d(x)
tensor([[0, 1],
[2, 3]]
&gt;&gt;&gt; x = torch.tensor(0.5)
&gt;&gt;&gt; y = torch.tensor(1.)
&gt;&gt;&gt; torch.atleast_2d((x, y))
(tensor([[0.5000]]), tensor([[1.]]))
"""
# 此包装器存在以支持可变参数。
if has_torch_function(tensors):
return handle_torch_function(atleast_2d, tensors, *tensors)
if len(tensors) == 1:
tensors = tensors[0]
return _VF.atleast_2d(tensors)  # type: ignore[attr-defined]</font></font></font></div>


<div class="viewcode-block" id="atleast_3d"><font class=" " lang="zh-CN"><br hidden=""><font class="    "><font class="  ">[文档]def 至少_3d(*tensors):
r"""
返回每个输入张量的 3 维视图，零维不变。
输入张量具有三个或更多维度时，将按原样返回。

Args:
输入 (Tensor 或 Tensor 列表)

返回:
输出 (Tensor 或 Tensor 元组)

示例：

&gt;&gt;&gt; x = torch.tensor(0.5)
&gt;&gt;&gt; x
tensor(0.5000)
&gt;&gt;&gt; torch.atleast_3d(x)
tensor([[[0.5000]]])
&gt;&gt;&gt; y = torch.arange(4).view(2, 2)
&gt;&gt;&gt; y
tensor([[0, 1],
])
[2, 3]])
&gt;&gt;&gt; torch.atleast_3d(y)
tensor([[[0],
])
[1]]
空白行
[2]
[3]]])
&gt;&gt;&gt; x = torch.tensor(1).view(1, 1, 1)
&gt;&gt;&gt; x
tensor([[[1]]])
&gt;&gt;&gt; torch.atleast_3d(x)
tensor([[[1]]])
&gt;&gt;&gt; x = torch.tensor(0.5)
&gt;&gt;&gt; y = torch.tensor(1.0)
&gt;&gt;&gt; torch.atleast_3d((x, y))
(tensor([[[0.5000]]]), tensor([[[1.]]]))
"""
# 此包装器存在以支持可变参数。
if has_torch_function(tensors):
return handle_torch_function(atleast_3d, tensors, *tensors)
if len(tensors) == 1:
tensors = tensors[0]
return _VF.atleast_3d(tensors)  # type: ignore[attr-defined]</font></font></font></div>


<span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">类型检查</span><span class="p">:</span>
    <span class="k">通过</span>
    <span class="c1">没有好的方法使用这个类型注解；无法将 norm()重命名为</span>
    <span class="c1"># _norm_impl() 的实现方式不会破坏 JIT 重载。所以保持未类型化</span>
    <span class="c1"># 目前用于 mypy。</span>
    <span class="c1">#    def norm(输入: Tensor,</span>
    <span class="c1">#             p: 可选[Union[str, Number]] = "fro",</span>
    <span class="c1">#             dim: 可选[Union[int, List[int]]] = None,</span>
    <span class="c1">#             keepdim: bool = False,</span>
    <span class="c1">#             out: 可选[Tensor] = None,</span>
    <span class="c1">#             数据类型：_dtype = None) -&gt; 张量:</span>
    <span class="c1">#        返回 _norm_impl(input, p, dim, keepdim, out, dtype)</span>
<span class="k">否则</span><span class="p">:</span>
    <span class="c1"># TODO：当 https://github.com/pytorch/pytorch/issues/33782 问题解决后，将 dim 类型更改为 BroadcastingList</span>
    <span class="c1"># https://github.com/pytorch/pytorch/issues/33782 修复后</span>
    <span class="nd">@overload</span>
    <span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">归一化</span><span class="p">(</span>
        <span class="nb">输入</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">拉丁</span><span class="p">,</span>
        <span class="n">维度</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
        <span class="n">保持维度</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">出</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
        <span class="n">数据类型</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1">(Tensor, str, Optional[List[int]], bool, Optional[Tensor], Optional[int]) -&gt; Tensor</span>
        <span class="k">通过</span>

    <span class="nd">@overload</span>
    <span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">归一化</span><span class="p">(</span>  <span class="c1"># noqa: F811</span>
        <span class="nb">输入</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">拉丁</span><span class="p">,</span>
        <span class="n">维度</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
        <span class="n">保持维度</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">出</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
        <span class="n">数据类型</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1">(Tensor, 可选[number], 可选[List[int]], bool, 可选[Tensor], 可选[int]) -&gt; Tensor</span>
        <span class="k">通过</span>

    <span class="nd">@overload</span>
    <span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">归一化</span><span class="p">(</span>  <span class="c1"># noqa: F811</span>
        <span class="nb">输入</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">拉丁</span><span class="p">,</span>
        <span class="n">维度</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
        <span class="n">保持维度</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">出</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
        <span class="n">数据类型</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1">(Tensor, 可选[number], 可选[int], bool, 可选[Tensor], 可选[int]) -&gt; Tensor</span>
        <span class="k">通过</span>

    <span class="nd">@overload</span>
    <span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">归一化</span><span class="p">(</span>  <span class="c1"># noqa: F811</span>
        <span class="nb">输入</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">拉丁</span><span class="p">,</span>
        <span class="n">维度</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
        <span class="n">保持维度</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">出</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
        <span class="n">数据类型</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1">(Tensor, str, 可选[int], bool, 可选[Tensor], 可选[int]) -&gt; Tensor</span>
        <span class="k">通过</span>


<div class="viewcode-block" id="norm"><a class="viewcode-back" href="../../generated/torch.norm.html#torch.norm">[文档]</font></font></font></a><span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">归一化</span><span class="p">(</span>  <span class="c1"># noqa: F811</span>
    <span class="nb">输入</span><span class="p">,</span>
    <span class="n">p</span><span class="p">:</span> <span class="n">可选</font></font></font></span><span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">联合</font></font></font></span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">拉丁</span><span class="p">,</span>
    <span class="n">维度</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
    <span class="n">保持维度</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">出</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
    <span class="n">数据类型</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">"返回给定张量的矩阵范数或向量范数。"</span>

<span class="sd">..警告::</span>

<span class="sd">torch.norm 已弃用，可能在未来的 PyTorch 版本中删除。</span>
<span class="sd">其文档和行为可能不正确，并且它已不再积极维护。</span>
<span class="sd">请使用 :func:`torch.linalg.vector_norm` 来计算向量范数，使用 :func:`torch.linalg.matrix_norm` 来计算矩阵范数。</span>

<span class="sd">当计算向量范数时使用 :func:`torch.linalg.vector_norm`，当计算矩阵范数时使用 :func:`torch.linalg.matrix_norm`。</span>
<span class="sd">请使用 :func:`torch.linalg.vector_norm` 来计算向量范数，使用 :func:`torch.linalg.matrix_norm` 来计算矩阵范数。</span>
<span class="sd">对于具有与此类似行为的函数，请参阅：:func:`torch.linalg.norm`。</span>
<span class="sd">然而，这些函数的签名与 `torch.norm` 的签名略有不同。</span>
<span class="sd">输入（张量）：输入张量。其数据类型必须是浮点型或复数类型。对于复数输入，范数计算使用的是 ...</span>

<span class="sd">参数：</span>
<span class="sd">输入（张量）：输入张量。它的数据类型必须是浮点型或复数类型。对于复数输入，范数计算使用的是 ...</span>
<span class="sd">输入（张量）：输入张量。它的数据类型必须是浮点型或复数类型。对于复数输入，范数计算使用的是 ...</span>
<span class="sd">每个元素的绝对值。如果输入是复数且既不是</span>
<span class="sd">:attr:`dtype` 或 :attr:`out` 未指定，结果的数据类型将</span>
<span class="sd">对应浮点类型（例如，如果 `:attr:`input` 是</span>
<span class="sd">复杂浮点数。</span>

<span class="sd">p (int, float, inf, -inf, 'fro', 'nuc', 可选): 范数的阶。默认：``'fro'``</span>
<span class="sd">可以计算以下范数：</span>

<span class="sd">            ======  ==============  ==========================</span>
<span class="sd">ord     矩阵范数     向量范数</span>
<span class="sd">            ======  ==============  ==========================</span>
<span class="sd">'fro'   Frobenius 范数  --</span>
<span class="sd">核范数    --</span>
<span class="sd">数量    --              sum(abs(x)**ord)**(1./ord)</span>
<span class="sd">            ======  ==============  ==========================</span>

<span class="sd">向量范数可以在任意维度上计算。</span>
<span class="sd">对应的维度被展平为 :attr:`input` 的维度。</span>
<span class="sd">一维，范数是在展平后计算的</span>
<span class="sd">维度。</span>

<span class="sd">弗罗贝尼乌斯范数在所有情况下都产生与 ``p=2`` 相同的结果</span>
<span class="sd">除非 :attr:`dim` 是三个或更多维度的列表，在这种情况下</span>
<span class="sd">的情况下，弗罗贝尼乌斯范数会抛出错误。</span>

<span class="sd">核范数只能计算在恰好两个维度上。</span>

<span class="sd">dim (int, int 元组，int 列表，可选):</span>
<span class="sd">指定要计算范数的 :attr:`input` 的哪个维度或哪些维度。</span>
<span class="sd">如果 :attr:`dim` 为 ``None``，则范数将在 :attr:`input` 的所有维度上计算。如果范数</span>
<span class="sd">是在所有维度上计算的，则 ...</span>
<span class="sd">由 :attr:`p` 指示的类型不支持指定的维度数量，将发生错误。</span>
<span class="sd">维度，将发生错误。</span>
<span class="sd">keepdim（布尔值，可选）：输出张量是否保留 :attr:`dim` 维度。如果 :attr:`dim` = ``None``，则忽略。</span>
<span class="sd">。如果 :attr:`dim` = ``None``，则忽略。</span>
<span class="sd">`out` = `None`. 默认：`False`</span>
<span class="sd">out (Tensor, 可选)：输出张量。如果忽略</span>
<span class="sd">`dim` = `None` 且 `out` = `None`</span>
<span class="sd">dtype (:class:`torch.dtype`, 可选)：期望的数据类型为</span>
<span class="sd">返回张量。如果指定，输入张量将被转换为</span>
<span class="sd">在执行操作时指定 `dtype`。默认：无。</span>

<span class="sd">.. 注意::</span>
<span class="sd">尽管 `p='fro'` 支持任意数量的维度，但真正的</span>
<span class="sd">数学定义的 Frobenius 范数仅适用于张量</span>
<span class="sd">精确到两个维度。:func:`torch.linalg.matrix_norm` 使用 ``ord='fro'``</span>
<span class="sd">与数学定义一致，因为它只能应用于</span>
<span class="sd">精确到两个维度。</span>

<span class="sd">示例::</span>

<span class="sd">&gt;&gt;&gt; 导入 torch</span>
<span class="sd">        &gt;&gt;&gt; a = torch.arange(9, dtype= torch.float) - 4</span>
<span class="sd">        &gt;&gt;&gt; b = a.reshape((3, 3))</span>
<span class="sd">        &gt;&gt;&gt; torch.norm(a)</span>
<span class="sd">        tensor(7.7460)</span>
<span class="sd">        &gt;&gt;&gt; torch.norm(b)</span>
<span class="sd">        tensor(7.7460)</span>
<span class="sd">        &gt;&gt;&gt; torch.norm(a, float('inf'))</span>
<span class="sd">        tensor(4.)</span>
<span class="sd">        &gt;&gt;&gt; torch.norm(b, float('inf'))</span>
<span class="sd">        tensor(4.)</span>
<span class="sd">        &gt;&gt;&gt; c = torch.tensor([[ 1, 2, 3], [-1, 1, 4]] , dtype=torch.float)</span>
<span class="sd">        &gt;&gt;&gt; torch.norm(c, dim=0)</span>
<span class="sd">        tensor([1.4142, 2.2361, 5.0000])</span>
<span class="sd">        &gt;&gt;&gt; torch.norm(c, dim=1)</span>
<span class="sd">        tensor([3.7417, 4.2426])</span>
<span class="sd">        &gt;&gt;&gt; torch.norm(c, p=1, dim=1)</span>
<span class="sd">        tensor([6., 6.])</span>
<span class="sd">        &gt;&gt;&gt; d = torch.arange(8, dtype=torch.float).reshape(2, 2, 2)</span>
<span class="sd">        &gt;&gt;&gt; torch.norm(d, dim=(1, 2))</span>
<span class="sd">        tensor([ 3.7417, 11.2250])</span>
<span class="sd">        &gt;&gt;&gt; torch.norm(d[0, :, :]), torch.norm(d[1, :, :])</span>
<span class="sd">(张量(3.7417), 张量(11.2250))</span>
<span class="sd">    """</span>

    <span class="k">如果</font></font></font></span> <span class="n">has_torch_function_unary</span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</span><span class="p">):</span>
        <span class="k">返回</span> <span class="n">handle_torch_function</span><span class="p">(</span>
            <span class="n">归一化</font></font></font></span><span class="p">,</span> <span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,),</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</span><span class="o">=</span><span class="n">dtype</span>
        <span class="p">)</span>

    <span class="c1"># 注意。所有重复的代码和奇怪的 Python 都是为了取悦 TorchScript。</span>
    <span class="c1">#     对于更紧凑的实现，请参阅 `_refs/__init__.py` 中的相关函数</span>

    <span class="c1"># 我们不对 MPS 或稀疏张量这样做</span>
    <span class="k">如果</font></font></font></span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">布局</font></font></font></span> <span class="o">==</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">稀疏的</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">和</font></font></font></span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">设备</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">类型</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">在</span> <span class="p">(</span>
        <span class="s2">"cpu"</span><span class="p">,</span>
        <span class="s2">cuda</span><span class="p">,</span>
        <span class="s2">元数据</span><span class="p">,</span>
        <span class="n">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">工具</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">后端注册</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_私有用途 1 后端名称</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">不</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
            <span class="k">如果</font></font></font></span> <span class="nb">isinstance</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</span><span class="o">.</span><span class="n">SymInt</span><span class="p">)):</span>
                <span class="n">_dim</span> <span class="o">=</span> <span class="p">[</span><span class="n">维度</span><span class="p">]</span>
            <span class="k">否则</span><span class="p">:</span>
                <span class="n">_dim</span> <span class="o">=</span> <span class="n">维度</span>
        <span class="k">否则</span><span class="p">:</span>
            <span class="n">_dim</span> <span class="o">=</span> <span class="kc">无</font></font></font></span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># 类型：忽略[赋值]</span>

        <span class="k">如果</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">如果</font></font></font></span> <span class="n">p</span> <span class="o">==</span> <span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">fro</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">和</span> <span class="p">(</span>
                <span class="n">维度</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">或者</font></font></font></span> <span class="nb">isinstance</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n">SymInt</span><span class="p">))</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">或者</font></font></font></span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">长度</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span>
            <span class="p">):</span>
                <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
                    <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">线性代数</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">向量范数</span><span class="p">(</span>
                        <span class="nb">输入</font></font></font></span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">模糊</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</span><span class="o">=</span><span class="n">dtype</span>
                    <span class="p">)</span>
                <span class="k">否则</span><span class="p">:</span>
                    <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">线性代数</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">向量范数</span><span class="p">(</span>
                        <span class="nb">输入</font></font></font></span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">模糊</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</span>
                    <span class="p">)</span>

            <span class="c1"># 我们可以称之为核范数，或者带有某些参数的矩阵范数</span>
            <span class="c1"># 这将引发错误</span>
            <span class="k">如果</font></font></font></span> <span class="n">_dim</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
                <span class="n">_dim</span> <span class="o">=</span> <span class="nb">列表</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">范围</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</span><span class="p">))</span>
            <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
                <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">线性代数</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">矩阵范数</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">模糊</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</span><span class="p">)</span>
            <span class="k">否则</span><span class="p">:</span>
                <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">线性代数</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">矩阵范数</span><span class="p">(</span>
                    <span class="nb">输入</font></font></font></span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">模糊</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</span>
                <span class="p">)</span>
        <span class="k">否则</span><span class="p">:</span>
            <span class="c1"># 注意：p 应该是 Union[str, number] 类型，而不是 Optional!</span>
            <span class="n">_p</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="k">如果</font></font></font></span> <span class="n">p</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</font></font></font></span> <span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">否则</span> <span class="n">p</span>
            <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
                <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">线性代数</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">向量范数</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n">_p</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">模糊</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</span><span class="p">)</span>
            <span class="k">否则</span><span class="p">:</span>
                <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">线性代数</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">向量范数</span><span class="p">(</span>
                    <span class="nb">输入</font></font></font></span><span class="p">,</span> <span class="n">_p</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">模糊</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</span>
                <span class="p">)</span>

    <span class="n">维数</font></font></font></span> <span class="o">=</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">()</span>

    <span class="c1"># 捕获默认情况</span>
    <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">和</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">和</font></font></font></span> <span class="n">dtype</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">和</font></font></font></span> <span class="n">p</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">不</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
        <span class="k">如果</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">如果</font></font></font></span> <span class="n">p</span> <span class="o">==</span> <span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">拉丁</span><span class="p">:</span>
                <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">Frobenius 范数</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span><span class="o">=</span><span class="p">(),</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</span><span class="p">)</span>
        <span class="k">如果</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">不</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">_dim</span> <span class="o">=</span> <span class="nb">列表</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">范围</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</span><span class="p">))</span>
            <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">归一化</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">模糊</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="p">)</span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># 类型：忽略[已定义]</span>

    <span class="c1"># TODO: 当 https://github.com/pytorch/pytorch/issues/33782 被修复时</span>
    <span class="c1"># 将 dim 为整数的重载移除，替换为 BraodcastingList1</span>
    <span class="c1"># 并删除下四行，将 _dim 替换为 dim</span>
    <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">不</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
        <span class="k">如果</font></font></font></span> <span class="nb">isinstance</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</span><span class="o">.</span><span class="n">SymInt</span><span class="p">)):</span>
            <span class="n">_dim</span> <span class="o">=</span> <span class="p">[</span><span class="n">维度</span><span class="p">]</span>
        <span class="k">否则</span><span class="p">:</span>
            <span class="n">_dim</span> <span class="o">=</span> <span class="n">维度</span>
    <span class="k">否则</span><span class="p">:</span>
        <span class="n">_dim</span> <span class="o">=</span> <span class="kc">无</font></font></font></span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># 类型：忽略[赋值]</span>

    <span class="k">如果</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">如果</font></font></font></span> <span class="n">p</span> <span class="o">==</span> <span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">拉丁</span><span class="p">:</span>
            <span class="k">如果</font></font></font></span> <span class="n">dtype</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">不</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
                <span class="k">抛出</font></font></font></span> <span class="ne"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">值错误</font></font></font></span><span class="p">(</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"dtype 参数不支持在 Frobenius 范数中"</span><span class="p">)</span>

            <span class="k">如果</font></font></font></span> <span class="n">_dim</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
                <span class="n">_dim</span> <span class="o">=</span> <span class="nb">列表</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">范围</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</span><span class="p">))</span>
            <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
                <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">Frobenius 范数</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">模糊</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
            <span class="k">否则</span><span class="p">:</span>
                <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">Frobenius 范数</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">模糊</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
        <span class="k">elif</span> <span class="n">p</span> <span class="o">==</span> <span class="s2">核</span><span class="p">:</span>
            <span class="k">如果</font></font></font></span> <span class="n">dtype</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">不</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
                <span class="k">抛出</font></font></font></span> <span class="ne"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">值错误</font></font></font></span><span class="p">(</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"核范数中不支持 dtype 参数"</span><span class="p">)</span>
            <span class="k">如果</font></font></font></span> <span class="n">_dim</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
                <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
                    <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">核范数</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
                <span class="k">否则</span><span class="p">:</span>
                    <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">核范数</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
            <span class="k">否则</span><span class="p">:</span>
                <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
                    <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">核范数</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">模糊</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
                <span class="k">否则</span><span class="p">:</span>
                    <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">核范数</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">模糊</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
        <span class="k">抛出</font></font></font></span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"仅有效的字符串值是 'fro' 和 'nuc'"</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">否则</span><span class="p">:</span>
        <span class="k">如果</font></font></font></span> <span class="n">_dim</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
            <span class="n">_dim</span> <span class="o">=</span> <span class="nb">列表</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">范围</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维数</span><span class="p">))</span>

        <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
            <span class="k">如果</font></font></font></span> <span class="n">dtype</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
                <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">归一化</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">模糊</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="p">)</span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># 类型：忽略[已定义]</span>
            <span class="k">否则</span><span class="p">:</span>
                <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">归一化</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">模糊</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</font></font></font></span><span class="p">)</span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># 类型：忽略[已定义]</span>
        <span class="k">否则</span><span class="p">:</span>
            <span class="k">如果</font></font></font></span> <span class="n">dtype</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
                <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">归一化</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">模糊</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="p">)</span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># 类型：忽略[已定义]</span>
            <span class="k">否则</span><span class="p">:</span>
                <span class="k">返回</font></font></font></span> <span class="n">_VF</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">归一化</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输入</font></font></font></span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">模糊</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">保持维度</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</span><span class="p">)</span>  <span class="c1"># type: ignore[attr-defined]</span></div>


<div class="viewcode-block" id="unravel_index"><a class="viewcode-back" href="../../generated/torch.unravel_index.html#torch.unravel_index">[文档]</font></font></font></a><span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">定义</span> <span class="nf">unravel_index</span><span class="p">(</span>
    <span class="n">索引</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">,</span>
    <span class="n">形状</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">联合</font></font></font></span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">序列</font></font></font></span><span class="p">[</span><span class="nb">int</span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">]</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">尺寸</font></font></font></span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">元组</font></font></font></span><span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="o">...</span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">]</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">将一个扁平索引的张量转换为坐标张量的元组</span>
<span class="sd">指定形状的任意张量的索引。</span>

<span class="sd">参数：</span>
<span class="sd">索引（Tensor）：一个整数张量，包含对形状的索引。</span>
<span class="sd">任意形状为 :attr:`shape` 的张量的扁平版本。</span>
<span class="sd">所有元素必须在范围 ``[0, prod(shape) - 1]`` 内。</span>

<span class="sd">形状（int、int 序列或 torch.Size）：任意张量的形状。所有元素必须为非负。</span>
<span class="sd">张量。所有元素必须为非负。</span>

<span class="sd">返回值：</span>
<span class="sd">张量元组的 Tensors：输出中的每个``i``-th 张量对应于：attr:`shape`的维度``i``。每个张量具有与形状相同的形状。</span>
<span class="sd">每个张量具有与形状相同的形状。</span>
<span class="sd">``indices`` 包含每个维度 ``i`` 的一个索引。</span>
<span class="sd">由 ``indices`` 给出的平面索引。</span>

<span class="sd">示例::</span>

<span class="sd">&gt;&gt;&gt; 导入 torch</span>
<span class="sd">        &gt;&gt;&gt; torch.unravel_index(torch.tensor(4), (3, 2))</span>
<span class="sd">        (tensor(2),</span>
<span class="sd">tensor(0)</span>

<span class="sd">        &gt;&gt;&gt; torch.unravel_index(torch.tensor([4, 1]), (3, 2))</span>
<span class="sd">        (tensor([2, 0]),</span>
<span class="sd">tensor([0, 1])</span>

<span class="sd">        &gt;&gt;&gt; torch.unravel_index(torch.tensor([0, 1, 2, 3, 4, 5]), (3, 2))</span>
<span class="sd">        (tensor([0, 0, 1, 1, 2, 2]),</span>
<span class="sd">         tensor([0, 1, 0, 1, 0, 1]))</span>

<span class="sd">        &gt;&gt;&gt; torch.unravel_index(torch.tensor([1234, 5678]), (10, 10, 10, 10))</span>
<span class="sd">(张量([1, 5]),</span>
<span class="sd">张量([2, 6]),</span>
<span class="sd">tensor([3, 7])</span>
<span class="sd">tensor([4, 8])</span>

<span class="sd">        &gt;&gt;&gt; torch.unravel_index(torch.tensor([[1234], [5678]]), (10, 10, 10, 10))</span>
<span class="sd">        (tensor([[1], [5]]),</span>
<span class="sd">tensor([[2], [6]])</span>
<span class="sd">tensor([[3], [7]])</span>
<span class="sd">tensor([[4], [8]])</span>

<span class="sd">        &gt;&gt;&gt; torch.unravel_index(torch.tensor([[1234], [5678]]), (100, 100))</span>
<span class="sd">(tensor([[12], [56]]))</span>
<span class="sd">         tensor([[34], [78]]))</span>
<span class="sd">    """</span>
    <span class="k">如果</font></font></font></span> <span class="n">has_torch_function_unary</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</span><span class="p">):</span>
        <span class="k">返回</font></font></font></span> <span class="n">handle_torch_function</span><span class="p">(</span><span class="n">unravel_index</span><span class="p">,</span> <span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="p">,),</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">)</span>
    <span class="n">累积张量</font></font></font></span> <span class="o">=</span> <span class="n">_unravel_index</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">)</span>
    <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">累积张量</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">解绑</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span></div>


<span class="k">定义</font></font></font></span> <span class="nf">_unravel_index</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</font></font></font></span><span class="p">:</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">联合</font></font></font></span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">序列</font></font></font></span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">:</span>
    <span class="n">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_检查类型</span><span class="p">(</span>
        <span class="ow">不</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是复杂的</span><span class="p">()</span>
        <span class="ow">和</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">不</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</span><span class="o">.</span><span class="n">is_floating_point</span><span class="p">()</span>
        <span class="ow">和</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">不</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</span><span class="o">.</span><span class="n">bool</span><span class="p">,</span>
        <span class="k">lambda</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"期望 'indices' 为整型数据类型，但得到</font></font></font></span><span class="si">{</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_检查类型</span><span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">形状</font></font></font></span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n">SymInt</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">序列</span><span class="p">)),</span>
        <span class="k">lambda</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"预期 'shape' 是 int 或 int 序列，但得到了"</font></font></font></span><span class="si">{</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">类型</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">如果</font></font></font></span> <span class="nb">isinstance</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</font></font></font></span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</span><span class="o">.</span><span class="n">SymInt</span><span class="p">)):</span>
        <span class="n">形状</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">尺寸</font></font></font></span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">[</font></font></font></span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">])</span>
    <span class="k">否则</span><span class="p">:</span>
        <span class="k">对于</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">在</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">:</span>
            <span class="n">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_检查类型</span><span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">维度</font></font></font></span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</span><span class="o">.</span><span class="n">SymInt</span><span class="p">)),</span>
                <span class="k">lambda</span><span class="p">:</span> <span class="sa">f</span><span class="s2">预期 'shape' 序列只应包含整数，但得到了</font></font></font></span><span class="si">{</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">类型</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">形状</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">尺寸</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">)</span>

    <span class="n">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">检查值</span><span class="p">(</span>
        <span class="nb">所有</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span> <span class="o"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">≥</font></font></font></span> <span class="mi">0</span> <span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">对于</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">维度</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">在</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">),</span>
        <span class="k">lambda</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"形状不能有负值，但得到了"</font></font></font></span><span class="si">{</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">元组</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">系数</font></font></font></span> <span class="o">=</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</span><span class="p">(</span>
        <span class="nb">反转</span><span class="p">(</span>
            <span class="nb">列表</span><span class="p">(</span>
                <span class="n">itertools</span><span class="o">.</span><span class="n">累加</span><span class="p">(</span>
                    <span class="nb">反转</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</font></font></font></span><span class="p">[</span><span class="mi">1</span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">]</font></font></font></span> <span class="o">+</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">尺寸</font></font></font></span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">[</font></font></font></span><span class="mi">1</span><span class="p">])),</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">函数</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">操作符</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">乘</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">展平</font></font></font></span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">向下取整除</span><span class="p">(</span>
        <span class="n">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">系数</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">设备</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">设备</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="p">)</span> <span class="o">%</span> <span class="n">火炬</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">形状</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">设备</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">索引</font></font></font></span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">设备</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">数据类型</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>


<div class="viewcode-block" id="chain_matmul"><font class=" " lang="zh-CN"><br hidden=""><font class="    "><font class="  ">[文档]def chain_matmul(*matrices, out=None):
返回 `N` 个二维张量的矩阵乘积。此乘积计算效率高。
使用矩阵链序算法，该算法选择最低成本的顺序
算术运算（`[CLRS]`_）的函数，注意由于这是一个计算乘积的函数，:math:`N`
需要大于等于 2；如果等于 2，则返回一个平凡的矩阵-矩阵乘积。
如果:math:`N`是 1，则这是一个无操作 - 原始矩阵按原样返回。

.. 警告::

`torch.chain_matmul` 已弃用，将在未来的 PyTorch 版本中删除。
请使用 :func:`torch.linalg.multi_dot` 代替，它接受一个包含两个或更多张量的列表
而不是多个参数。

参数：
矩阵（张量...）：要确定乘积的 2 个或更多 2-D 张量序列。
out（张量，可选）：输出张量。如果：attr:`out` = ``None``，则忽略。

返回：
张量：如果第：math:`i^{th}` 张量的维度为：math:`p_{i} \times p_{i + 1}`，则乘积
将会是维度为 :math:`p_{1} \times p_{N + 1}` 的。

示例::

&gt;&gt;&gt; # xdoctest: +SKIP
&gt;&gt;&gt; # xdoctest: +IGNORE_WANT("非确定性的")
&gt;&gt;&gt; a = torch.randn(3, 4)
&gt;&gt;&gt; b = torch.randn(4, 5)
&gt;&gt;&gt; c = torch.randn(5, 6)
&gt;&gt;&gt; d = torch.randn(6, 7)
# 将引发弃用警告
&gt;&gt;&gt; torch.chain_matmul(a, b, c, d)
tensor([[ -2.3375,  -3.9790,  -4.1119,  -6.6577,   9.5609, -11.5095,  -3.2614],
[ 21.4038,   3.3378,  -8.4982,  -5.2457, -10.2561,  -2.4684,   2.7163],
[[-0.9647, -5.8917, -2.3213, -5.2284, 12.8615, -12.2816, -2.5095]])

.. 参考文献请见[CLRS](https://mitpress.mit.edu/books/introduction-algorithms-third-edition)
"""
# 此包装器存在是为了支持可变参数。
如果有 torch_function(matrices):
返回 handle_torch_function(chain_matmul, matrices, *matrices)

如果 out 为 None:
返回_VF.chain_matmul(matrices)  # type: ignore[attr-defined]
else:
返回 _VF.chain_matmul(matrices, out=out)  # 忽略属性定义错误</font></font></font></div>


<span class="k">定义</font></font></font></span> <span class="nf">_lu_impl</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">轴心</font></font></font></span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">获取信息</font></font></font></span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">):</span>
    <span class="c1"># 类型: (Tensor, bool, bool, Any) -&gt; tuple[Tensor, Tensor, Tensor]</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">计算矩阵或矩阵批次的 LU 分解</span>
<span class="sd">返回包含矩阵 :attr:`A` 的 LU 分解和</span>
<span class="sd">交换因子的元组。如果 :attr:`pivot` 设置为</span>
<span class="sd">``True``，则进行交换。</span>

<span class="sd">..警告::</span>

<span class="sd">`:func:`torch.lu` 已弃用，推荐使用 :func:`torch.linalg.lu_factor`。</span>
<span class="sd">and :func:`torch.linalg.lu_factor_ex`。:func:`torch.lu` 将在下一个版本中删除。</span>
<span class="sd">未来 PyTorch 版本。</span>
<span class="sd">`LU, 旋转，信息 = torch.lu(A, 计算旋转)`</span>

<span class="sd">.. 代码块 :: python</span>

<span class="sd">            LU, pivots = torch.linalg.lu_factor(A, compute_pivots)</span>

<span class="sd">``LU, pivots, info = torch.lu(A, compute_pivots, get_infos=True)`` 应该替换为</span>

<span class="sd">.. 代码块 :: python</span>

<span class="sd">LU 分解，pivot，信息 = torch.linalg.lu_factor_ex(A, compute_pivots)</span>

<span class="sd">.. 注意::</span>
<span class="sd">* 每个矩阵返回的置换矩阵表示为一个大小为 ``min(A.shape[-2], A.shape[-1])`` 的 1 索引向量。</span>
<span class="sd">``pivots[i] == j`` 表示在算法的第 i 步中，</span>
<span class="sd">算法中第 i 步的 pivot[i]等于 j。</span>
<span class="sd">第 i 行与第 j-1 行进行了置换。</span>
<span class="sd">当 :attr:`pivot` = ``False`` 时，不可用 LU 分解，尝试这样做将引发错误。</span>
<span class="sd">对于 CPU，并且尝试这样做将会抛出错误。然而，</span>
<span class="sd">当 :attr:`pivot` = ``False`` 时，LU 分解是可用的。</span>
<span class="sd">          CUDA.</span>
<span class="sd">此函数不检查分解是否成功</span>
<span class="sd">或如果不：attr:`get_infos` 是 ``True``，则状态为</span>
<span class="sd">分解存在于返回元组的第三个元素中。</span>
<span class="sd">在大小小于或等于的平方矩阵批次的情况下</span>
<span class="sd">将 32 个在 CUDA 设备上，LU 分解被重复进行</span>
<span class="sd">由于 MAGMA 库中的错误，导致单矩阵</span>
<span class="sd">（参见熔岩问题 13）。</span>
<span class="sd">使用 :func:`torch.lu_unpack` 可以导出 ``L``、``U`` 和 ``P``。</span>

<span class="sd">..警告::</span>
<span class="sd">当 :attr:`A` 是满秩时，该函数的梯度才会是有限的。</span>
<span class="sd">这是因为 LU 分解仅在满秩矩阵处可微。</span>
<span class="sd">此外，如果 :attr:`A` 接近非满秩，则</span>
<span class="sd">梯度将数值不稳定，因为它依赖于 :math:`L^{-1}` 和 :math:`U^{-1}` 的计算。</span>

<span class="sd">参数：</span>
<span class="sd">A（张量）：要分解的尺寸为 :math:`(*, m, n)` 的张量。</span>
<span class="sd">pivot（布尔值，可选）：控制是否进行置换。默认：``True``。</span>
<span class="sd">get_infos（布尔值，可选）：如果设置为 ``True``，则返回一个信息 IntTensor。</span>
<span class="sd">默认：``False``</span>
<span class="sd">输出（元组，可选）：可选输出元组。如果 :attr:`get_infos` 是 ``True``，</span>
<span class="sd">则元组中的元素是 Tensor，IntTensor，</span>
<span class="sd">和 IntTensor。如果 :attr:`get_infos` 是 ``False``，则</span>
<span class="sd">元组中的元素为 Tensor，IntTensor。默认值：``None``</span>

<span class="sd">返回值：</span>
<span class="sd">(Tensor, IntTensor, IntTensor（可选）)：包含张量的元组</span>

<span class="sd">- **分解** (*Tensor*)：大小为 :math:`(*, m, n)` 的分解</span>

<span class="sd">- **主元** (*IntTensor*)：大小为 :math:`(*, \text{min}(m, n))` 的主元</span>
<span class="sd">``pivots`` 存储所有行的中间转置。</span>
<span class="sd">最终排列 ``perm`` 可以通过</span>
<span class="sd">应用 ``swap(perm[i], perm[pivots[i] - 1])`` 对于 ``i = 0, ..., pivots.size(-1) - 1`` 来重建，</span>
<span class="sd">其中 ``perm`` 初始为 :math:`m` 个元素的恒等排列</span>
<span class="sd">这实际上就是 :func:`torch.lu_unpack` 函数所做的事情。</span>

<span class="sd">- **infos** (*IntTensor*, *可选*): 如果 :attr:`get_infos` 是 ``True``，则这是一个张量，</span>
<span class="sd">大小为 :math:`(*)`，其中非零值表示矩阵或每个小批量因式分解是否成功。</span>
<span class="sd">失败。</span>

<span class="sd">示例::</span>

<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(env:TORCH_DOCTEST_LAPACK)</span>
<span class="sd">&gt;&gt;&gt; # xdoctest: +IGNORE_WANT("非确定性")</span>
<span class="sd">        &gt;&gt;&gt; A = torch.randn(2, 3, 3)</span>
<span class="sd">        &gt;&gt;&gt; A_LU, pivots = torch.lu(A)</span>
<span class="sd">        &gt;&gt;&gt; A_LU</span>
<span class="sd">        tensor([[[ 1.3506,  2.5558, -0.0816],</span>
<span class="sd">                 [ 0.1684,  1.1551,  0.1940],</span>
<span class="sd">                 [ 0.1193,  0.6189, -0.5497]],</span>

<span class="sd">[[0.4526, 1.2526, -0.3285]]</span>
<span class="sd">[[-0.7988, 0.7175, -0.9701]]</span>
<span class="sd">[[0.2634, -0.9255, -0.3459]]</span>
<span class="sd">&gt;&gt;&gt; 旋转轴</span>
<span class="sd">        tensor([[ 3,  3,  3],</span>
<span class="sd">                [ 3,  3,  3]], dtype=torch.int32)</span>
<span class="sd">        &gt;&gt;&gt; A_LU, pivots, info = torch.lu(A, get_infos=True)</span>
<span class="sd">&gt;&gt;&gt; 如果 info.nonzero().size(0)等于 0:</span>
<span class="sd">...     打印('所有样本的 LU 分解成功！')</span>
<span class="sd">所有样本的 LU 分解成功！</span>
<span class="sd">    """</span>
    <span class="c1"># 如果 get_infos 为 True，则不需要检查错误，反之亦然</span>
    <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">火炬</font></font></font></span><span class="o">.</span><span class="n">_lu_with_info</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">轴心</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">轴心</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">检查错误</font></font></font></span><span class="o">=</span><span class="p">(</span><span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">不</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">获取信息</span><span class="p">))</span>


<span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">类型检查</span><span class="p">:</span>
    <span class="n">_列表或序列</font></font></font></span> <span class="o">=</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">序列</font></font></font></span><span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">]</span>
<span class="k">否则</span><span class="p">:</span>
    <span class="n">_列表或序列</font></font></font></span> <span class="o">=</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</font></font></font></span><span class="p">[</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">]</span>


<span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">_检查列表大小</font></font></font></span><span class="p">(</span><span class="n">out_len</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">获取信息</font></font></font></span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="p">:</span> <span class="n">_ListOrSeq</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
    <span class="n">获取信息_int</font></font></font></span> <span class="o">=</span> <span class="mi">1</span> <span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">获取信息</font></font></font></span> <span class="k"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">否则</span> <span class="mi">0</span>
    <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">输出长度</font></font></font></span> <span class="o">-</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">获取信息_int</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">抛出</font></font></font></span> <span class="ne"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">类型错误</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"预期的元组，但得到的是"</font></font></font></span><span class="si">{</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">获取信息</font></font></font></span><span class="p">)</span><span class="si">}</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">元素的数量，但得到了"</span><span class="si">{</span><span class="n">out_len</span><span class="si">}</span><span class="s2">"</span>
        <span class="p">)</span>
    <span class="k">如果</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">不</font></font></font></span> <span class="nb">isinstance</span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="p">,</span> <span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">元组</font></font></font></span><span class="p">,</span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">列表</span><span class="p">)):</span>
        <span class="k">抛出</font></font></font></span> <span class="ne"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">类型错误</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"参数 'out' 必须是 Tensors 的元组，不是"</font></font></font></span><span class="si">{</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">类型</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">"</span>
        <span class="p">)</span>


<span class="k">定义</font></font></font></span> <span class="nf">_lu_with_infos</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">轴心</font></font></font></span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">获取信息</font></font></font></span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">):</span>
    <span class="c1"># 类型: (Tensor, bool, bool, Optional[tuple[Tensor, Tensor, Tensor]]) -&gt; tuple[Tensor, Tensor, Tensor]</span>
    <span class="k">如果</span> <span class="n">has_torch_function_unary</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
        <span class="k">返回</span> <span class="n">handle_torch_function</span><span class="p">(</span>
            <span class="n">lu</span><span class="p">,</span> <span class="p">(</span><span class="n">A</span><span class="p">,),</span> <span class="n">A</span><span class="p">,</span> <span class="n">轴心</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">轴心</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">获取信息</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">获取信息</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</span>
        <span class="p">)</span>
    <span class="n">结果</font></font></font></span> <span class="o">=</span> <span class="n">_lu_impl</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">轴心</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">获取信息</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</span><span class="p">)</span>
    <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">不</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
        <span class="n">_检查列表大小</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">长度</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="p">),</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">获取信息</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</span><span class="p">)</span>
        <span class="k">对于</font></font></font></span> <span class="n">i</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">在</font></font></font></span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">范围</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">长度</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</span><span class="p">)):</span>
            <span class="n">出</font></font></font></span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">调整大小为_</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">结果</font></font></font></span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">复制_</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">结果</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</span>
    <span class="k">否则</span><span class="p">:</span>
        <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">结果</font></font></font></span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># A_LU, 旋转轴，信息</span>


<span class="k">定义</font></font></font></span> <span class="nf">_lu_no_infos</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">轴心</font></font></font></span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">获取信息</font></font></font></span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="o">=</span><span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">):</span>
    <span class="c1"># type: (张量, 布尔值, 布尔值, 可选[tuple[张量, 张量]]) -&gt; tuple[张量, 张量]</span>
    <span class="c1"># 需要在这里检查 torch_function，以便在退出时</span>
    <span class="k">如果</span> <span class="n">has_torch_function_unary</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
        <span class="k">返回</span> <span class="n">handle_torch_function</span><span class="p">(</span>
            <span class="n">lu</span><span class="p">,</span> <span class="p">(</span><span class="n">A</span><span class="p">,),</span> <span class="n">A</span><span class="p">,</span> <span class="n">轴心</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">轴心</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">获取信息</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">获取信息</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="o">=</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</span>
        <span class="p">)</span>
    <span class="n">结果</font></font></font></span> <span class="o">=</span> <span class="n">_lu_impl</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">轴心</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">获取信息</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</span><span class="p">)</span>
    <span class="k">如果</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">是</font></font></font></span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">不</font></font></font></span> <span class="kc"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">无</span><span class="p">:</span>
        <span class="n">_检查列表大小</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">长度</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</font></font></font></span><span class="p">),</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">获取信息</font></font></font></span><span class="p">,</span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</span><span class="p">)</span>
        <span class="k">对于</font></font></font></span> <span class="n">i</span> <span class="ow"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">在</font></font></font></span> <span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">范围</font></font></font></span><span class="p">(</span><span class="nb"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">长度</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">出</span><span class="p">)):</span>
            <span class="n">出</font></font></font></span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">调整大小为_</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">结果</font></font></font></span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">复制_</font></font></font></span><span class="p">(</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">结果</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">外部</span>
    <span class="k">否则</span><span class="p">:</span>
        <span class="k">返回</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">结果</font></font></font></span><span class="p">[</span><span class="mi">0</span><span class="p"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">]</font></font></font></span> <span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">结果</font></font></font></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  "># A_LU，枢轴</span>


<span class="c1">lu 的返回类型取决于`get_infos`，因此为了解决在 TorchScript 中 lu 的输出类型，我们需要静态地知道`get_infos`的值</span>
<span class="c1">lu 在 TorchScript 中的输出类型需要静态地知道`get_infos`的值</span>
<span class="n">lu</span> <span class="o">=</span> <span class="n">布尔分发</span><span class="p">(</span>
    <span class="n">参数名称</font></font></font></span><span class="o">=</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">get_infos</span><span class="p">,</span>
    <span class="n">索引参数</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">默认</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">如果为真</span><span class="o">=</span><span class="n">_lu_with_infos</span><span class="p">,</span>
    <span class="n">如果为假</span><span class="o">=</span><span class="n">_lu_no_infos</span><span class="p">,</span>
    <span class="n">模块名称</span><span class="o">=</span><span class="vm">__name__</span><span class="p">,</span>
    <span class="n">函数名</span><span class="o">=</span><span class="s2">"lu"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">lu</span><span class="o">.</span><span class="vm">__文档__</font></font></font></span> <span class="o">=</span> <span class="n">_lu_impl</span><span class="o">.</span><span class="vm"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">__文档__</span>


<span class="k">定义</font></font></font></span> <span class="nf"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">对齐张量</font></font></font></span><span class="p">(</span><span class="o">*</span><span class="n"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">张量</span><span class="p">):</span>
    <span class="k">抛出</font></font></font></span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2"><font class=" " lang="zh-CN"><br hidden=""><font class="   "><font class="  ">"对齐张量尚未实现。"</span><span class="p">)</span>
</pre></div>

             </article>
             
            </div>
            <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>© 版权所有 PyTorch 贡献者。</p>
  </div>
    
      <div>使用 Sphinx 构建，并使用 Read the Docs 提供的主题。</div>
     

</footer>

          </div>
<script>

var match = window.location.href.match(/\/_[a-zA-Z0-9_]*.html|_dynamo/gi);
var url = window.location.href.lastIndexOf(match[match.length-1]);

if (url)
  {
    var div = '<div class="admonition note"><p class="admonition-title">Note</p><p><i class="fa fa-exclamation-circle" aria-hidden="true">&nbsp</i> This page describes an internal API which is not intended to be used outside of the PyTorch codebase and can be modified or removed without notice.</p></div>'
    document.getElementById("pytorch-article").insertAdjacentHTML('afterBegin', div)
  }
</script>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              
            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
         <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
         <script src="../../_static/jquery.js"></script>
         <script src="../../_static/underscore.js"></script>
         <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
         <script src="../../_static/doctools.js"></script>
         <script src="../../_static/clipboard.min.js"></script>
         <script src="../../_static/copybutton.js"></script>
     

  

  <script type="text/javascript" src="../../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 
<script script="" type="text/javascript">
  var collapsedSections = ['Developer Notes', 'Language Bindings', 'Libraries', 'Community'];
</script>

<img height="1" width="1" style="border-style:none;" alt="" src="https://www.googleadservices.com/pagead/conversion/795629140/?label=txkmCPmdtosBENSssfsC&amp;guid=ON&amp;script=0">


  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>文档</h2>
          <p>PyTorch 的全面开发者文档</p>
          <a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">查看文档</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>教程</h2>
          <p>深入了解初学者和高级开发者的教程</p>
          <a class="with-right-arrow" href="https://pytorch.org/tutorials">查看教程</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>资源</h2>
          <p>查找开发资源，获取您的疑问解答</p>
          <a class="with-right-arrow" href="https://pytorch.org/resources">查看资源</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch.org/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
            <li><a href="https://pytorch.org/get-started">开始使用</a></li>
            <li><a href="https://pytorch.org/features">功能</a></li>
            <li><a href="https://pytorch.org/ecosystem">生态系统</a></li>
            <li><a href="https://pytorch.org/blog/">博客</a></li>
            <li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md">贡献</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/resources">资源</a></li>
            <li><a href="https://pytorch.org/tutorials">教程</a></li>
            <li><a href="https://pytorch.org/docs/stable/index.html">文档</a></li>
            <li><a href="https://discuss.pytorch.org" target="_blank">讨论</a></li>
            <li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github 问题</a></li>
            <li><a href="https://pytorch.org/assets/brand-guidelines/PyTorch-Brand-Guidelines.pdf" target="_blank">品牌指南</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title">保持更新</li>
            <li><a href="https://www.facebook.com/pytorch" target="_blank">脸书</a></li>
            <li><a href="https://twitter.com/pytorch" target="_blank">推特</a></li>
            <li><a href="https://www.youtube.com/pytorch" target="_blank">YouTube</a></li>
            <li><a href="https://www.linkedin.com/company/pytorch" target="_blank">领英</a></li>
          </ul>  
          </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title">PyTorch 播客</li>
            <li><a href="https://open.spotify.com/show/6UzHKeiy368jKfQMKKvJY5" target="_blank">Spotify</a></li>
            <li><a href="https://podcasts.apple.com/us/podcast/pytorch-developer-podcast/id1566080008" target="_blank">苹果</a></li>
            <li><a href="https://www.google.com/podcasts?feed=aHR0cHM6Ly9mZWVkcy5zaW1wbGVjYXN0LmNvbS9PQjVGa0lsOA%3D%3D" target="_blank">谷歌</a></li>
            <li><a href="https://music.amazon.com/podcasts/7a4e6f0e-26c2-49e9-a478-41bd244197d0/PyTorch-Developer-Podcast?" target="_blank">亚马逊</a></li>
          </ul>
         </div>
        </div>
        
        <div class="privacy-policy">
          <ul>
            <li class="privacy-policy-links"><a href="https://www.linuxfoundation.org/terms/" target="_blank">条款</a></li>
            <li class="privacy-policy-links">|</li>
            <li class="privacy-policy-links"><a href="https://www.linuxfoundation.org/privacy-policy/" target="_blank">隐私</a></li>
          </ul>
        </div>
        <div class="copyright">
        <p>© 版权所有 Linux 基金会。PyTorch 基金会是 Linux 基金会的一个项目。有关 PyTorch 基金会的网站使用条款、商标政策以及其他适用政策，请参阅 www.linuxfoundation.org/policies/。PyTorch 基金会支持 PyTorch 开源项目，该项目已被确立为 LF Projects, LLC 的 PyTorch 项目系列。有关适用于 PyTorch 项目系列 LF Projects, LLC 的政策，请参阅 www.lfprojects.org/policies/。</p>
      </div>
     </div>

  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">为了分析流量并优化您的体验，我们在本网站上使用 cookies。通过点击或导航，您同意允许我们使用 cookies。作为本网站的当前维护者，适用 Facebook 的 Cookies 政策。了解更多信息，包括关于可用控制的信息：Cookies 政策。</p>
    <img class="close-button" src="../../_static/images/pytorch-x.svg" width="16" height="16">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
           <li class="resources-mobile-menu-title">
             <a>学习</a>
           </li>
           <ul class="resources-mobile-menu-items">
             <li>
               <a href="https://pytorch.org/get-started">开始使用</a>
             </li>
             <li>
               <a href="https://pytorch.org/tutorials">教程</a>
             </li>
             <li>
               <a href="https://pytorch.org/tutorials/beginner/basics/intro.html">学习基础知识</a>
             </li>
             <li>
               <a href="https://pytorch.org/tutorials/recipes/recipes_index.html">PyTorch 食谱</a>
             </li>
             <li>
               <a href="https://pytorch.org/tutorials/beginner/introyt.html">PyTorch 入门 - YouTube 系列</a>
             </li>
           </ul>
           <li class="resources-mobile-menu-title">
             <a>生态系统</a>
           </li>
           <ul class="resources-mobile-menu-items">
             <li>
               <a href="https://pytorch.org/ecosystem">工具</a>
             </li>
             <li>
               <a href="https://pytorch.org/#community-module">社区</a>
             </li>
             <li>
               <a href="https://discuss.pytorch.org/">论坛</a>
             </li>
             <li>
               <a href="https://pytorch.org/resources">开发者资源</a>
             </li>
             <li>
               <a href="https://pytorch.org/ecosystem/contributor-awards-2023">贡献者奖项 - 2024</a>
             </li>
           </ul>

           <li class="resources-mobile-menu-title">
             <a>Edge</a>
           </li>

           <ul class="resources-mobile-menu-items">
             <li>
               <a href="https://pytorch.org/edge">关于 PyTorch Edge</a>
             </li>
             
             <li>
               <a href="https://pytorch.org/executorch-overview">执行火炬</a>
             </li>
             <li>
               <a href="https://pytorch.org/executorch/stable/index.html">ExecuTorch 文档</a>
             </li>
           </ul>

           <li class="resources-mobile-menu-title">
             <a>文档</a>
           </li>

           <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://pytorch.org/docs/stable/index.html">PyTorch</a>
            </li>

            <li>
              <a href="https://pytorch.org/pytorch-domains">PyTorch 领域</a>
            </li>
          </ul>

          <li class="resources-mobile-menu-title">
            <a>博客 &amp; 新闻</a>
          </li>
            
           <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://pytorch.org/blog/">PyTorch 博客</a>
            </li>
            <li>
              <a href="https://pytorch.org/community-blog">社区博客</a>
            </li>

            <li>
              <a href="https://pytorch.org/videos">视频</a>
            </li>

            <li>
              <a href="https://pytorch.org/community-stories">社区故事</a>
            </li>
            <li>
              <a href="https://pytorch.org/events">活动</a>
            </li>
            <li>
               <a href="https://pytorch.org/newsletter">新闻简报</a>
             </li>
          </ul>
          
          <li class="resources-mobile-menu-title">
            <a>关于</a>
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://pytorch.org/foundation">PyTorch 基金会</a>
            </li>
            <li>
              <a href="https://pytorch.org/governing-board">治理委员会</a>
            </li>
            <li>
               <a href="https://pytorch.org/credits">云信用计划</a>
            </li>
            <li>
               <a href="https://pytorch.org/tac">技术咨询委员会</a>
            </li>
            <li>
               <a href="https://pytorch.org/staff">员工</a>
            </li>
            <li>
               <a href="https://pytorch.org/contact-us">联系我们</a>
            </li>
          </ul>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>

</body></html>